<!DOCTYPE html>
<html lang="en">
<head>
    <!-- IMPORTANT: Make sure your text editor saves this file with UTF-8 Encoding! -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Approaches to Ethics Quiz - Chapter 2</title> <!-- Changed Title -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input[type="text"], input[type="email"], input[type="tel"], input[type="password"] { width: 100%; padding: 8px; box-sizing: border-box; }
        input[type="radio"] { margin-right: 5px; }
        button { padding: 10px 20px; background-color: #007bff; color: white; border: none; cursor: pointer; margin-right: 10px; border-radius: 5px; }
        button:hover { background-color: #0056b3; }
        .hidden { display: none; }
        #error-message, #password-error, #login-error { color: red; font-size: 1.2em; text-align: center; }
        #success-message { color: green; font-size: 1.2em; text-align: center; }
        #results, #review-section, #submission-copy { margin-top: 20px; text-align: left; border: 1px solid #ccc; padding: 15px; border-radius: 5px; background-color: #f9f9f9;}
        #password-section, #login-section { text-align: center; max-width: 400px; margin: 20px auto; padding: 20px; border: 1px solid #ccc; border-radius: 5px; background-color: #f9f9f9;}
        #password-section input[type="password"], #login-section input[type="text"], #login-section input[type="password"] { width: calc(100% - 18px); }
        .question-result { margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid #eee; }
        #download-pdf, #download-response { margin-top: 10px; }
        #score { font-weight: bold; text-align: center; color: green; font-size: 1.4em; margin-top: 20px; }
        #review-section h2, #submission-copy h2, #results h1 { margin-bottom: 15px; text-align: center; color: #007bff;}
        #review-section button, #submission-copy button, #password-section button, #login-section button, #results button { margin-top: 15px; }
        .choices p { margin: 2px 0 2px 20px; }
    </style>
</head>
<body>
    <div id="login-section">
        <h1>Login to Access Quiz</h1>
        <div class="form-group">
            <label for="username">Username:</label>
            <input type="text" id="username" placeholder="Enter username" required>
        </div>
        <div class="form-group">
            <label for="login-password">Password:</label>
            <input type="password" id="login-password" placeholder="Enter password" required>
        </div>
        <button onclick="checkLogin()">Login</button>
        <p id="login-error" class="hidden">Incorrect username or password. Please try again.</p>
    </div>

    <div id="quiz-form" class="hidden">
        <h1>Approaches to Ethics Quiz - Chapter 2</h1> <!-- Changed Title -->
        <form id="mcie-quiz"> <!-- ID Kept, but content changed -->
            <!-- Student Information -->
            <div class="form-group">
                <label for="name">Name:</label>
                <input type="text" id="name" name="name" required>
            </div>
            <div class="form-group">
                <label for="id_number">ID Number:</label>
                <input type="text" id="id_number" name="id_number" required>
            </div>
            <div class="form-group">
                <label for="section">Section:</label>
                <input type="text" id="section" name="section" required>
            </div>
            <div class="form-group">
                <label for="email">Email:</label>
                <input type="email" id="email" name="email" required>
            </div>
            <div class="form-group">
                <label for="phone">Phone Number:</label>
                <input type="tel" id="phone" name="phone" required>
            </div>

            <!-- Approaches to Ethics Multiple-Choice Questions -->
             <div class="form-group">
                 <label>1. Normative ethics is primarily concerned with:</label>
                 <input type="radio" name="q1" value="A" required> A) Analyzing the meaning of ethical terms like 'good' and 'right'.<br>
                 <input type="radio" name="q1" value="B"> B) Describing how people actually behave in moral situations.<br>
                 <input type="radio" name="q1" value="C"> C) Offering theories or accounts of the best way to live and evaluating actions systematically.<br>
                 <input type="radio" name="q1" value="D"> D) Studying the historical development of moral codes.
             </div>
             <div class="form-group">
                 <label>2. Teleological ethical theories determine the morality of an action based on its:</label>
                 <input type="radio" name="q2" value="A" required> A) Adherence to universal moral rules.<br>
                 <input type="radio" name="q2" value="B"> B) Consequences or outcomes.<br>
                 <input type="radio" name="q2" value="C"> C) The intention or motive of the actor.<br>
                 <input type="radio" name="q2" value="D"> D) The virtues or character traits it demonstrates.
             </div>
             <div class="form-group">
                 <label>3. The phrase "the end justifies the means" is most characteristic of which type of ethical theory?</label>
                 <input type="radio" name="q3" value="A" required> A) Deontological ethics<br>
                 <input type="radio" name="q3" value="B"> B) Virtue ethics<br>
                 <input type="radio" name="q3" value="C"> C) Teleological ethics<br>
                 <input type="radio" name="q3" value="D"> D) Meta-ethics
             </div>
             <div class="form-group">
                 <label>4. According to teleological theories, the moral quality of an action is dependent on:</label>
                 <input type="radio" name="q4" value="A" required> A) Its conformity to divine commands.<br>
                 <input type="radio" name="q4" value="B"> B) The inherent nature of the act itself.<br>
                 <input type="radio" name="q4" value="C"> C) The nonmoral value it produces.<br>
                 <input type="radio" name="q4" value="D"> D) Its consistency when universalized.
             </div>
             <div class="form-group">
                 <label>5. A key difference between ethical egoism and utilitarianism is:</label>
                 <input type="radio" name="q5" value="A" required> A) Ethical egoism focuses on consequences, while utilitarianism focuses on duties.<br>
                 <input type="radio" name="q5" value="B"> B) Ethical egoism promotes the agent's own good, while utilitarianism promotes the greatest general good.<br>
                 <input type="radio" name="q5" value="C"> C) Ethical egoism is a deontological theory, while utilitarianism is teleological.<br>
                 <input type="radio" name="q5" value="D"> D) Ethical egoism considers pleasure, while utilitarianism considers only duty.
             </div>
             <div class="form-group">
                 <label>6. Psychological egoism is the view that:</label>
                 <input type="radio" name="q6" value="A" required> A) People ought to act only in their self-interest.<br>
                 <input type="radio" name="q6" value="B"> B) People always act in ways they perceive to be in their own self-interest.<br>
                 <input type="radio" name="q6" value="C"> C) Selfishness is morally commendable.<br>
                 <input type="radio" name="q6" value="D"> D) Altruism is the primary motivator for all human actions.
             </div>
             <div class="form-group">
                 <label>7. The argument that connects psychological egoism to ethical egoism often relies on the principle:</label>
                 <input type="radio" name="q7" value="A" required> A) "The ends justify the means."<br>
                 <input type="radio" name="q7" value="B"> B) "Treat others as you wish to be treated."<br>
                 <input type="radio" name="q7" value="C"> C) "Ought implies can."<br>
                 <input type="radio" name="q7" value="D"> D) "Act only on that maxim you can will as universal law."
             </div>
             <div class="form-group">
                 <label>8. Utilitarianism, as formulated by Bentham and Mill, is a form of:</label>
                 <input type="radio" name="q8" value="A" required> A) Ethical egoism<br>
                 <input type="radio" name="q8" value="B"> B) Deontology<br>
                 <input type="radio" name="q8" value="C"> C) Virtue ethics<br>
                 <input type="radio" name="q8" value="D"> D) Ethical universalism (a type of teleological theory)
             </div>
             <div class="form-group">
                 <label>9. Jeremy Bentham's utilitarianism emphasized maximizing pleasure based on its:</label>
                 <input type="radio" name="q9" value="A" required> A) Quality and type (higher vs. lower).<br>
                 <input type="radio" name="q9" value="B"> B) Quantitative aspects (intensity, duration, certainty, etc.).<br>
                 <input type="radio" name="q9" value="C"> C) Adherence to traditional moral rules.<br>
                 <input type="radio" name="q9" value="D"> D) Source in divine revelation.
             </div>
             <div class="form-group">
                 <label>10. John Stuart Mill refined utilitarianism by arguing that:</label>
                 <input type="radio" name="q10" value="A" required> A) All pleasures are equal in value.<br>
                 <input type="radio" name="q10" value="B"> B) The quantity of pleasure is the only factor that matters.<br>
                 <input type="radio" name="q10" value="C"> C) Some kinds of pleasure (intellectual, cultural) are qualitatively superior to others.<br>
                 <input type="radio" name="q10" value="D"> D) Utilitarian calculations are impossible to perform.
             </div>
             <div class="form-group">
                 <label>11. Act-utilitarianism determines the rightness of an action by:</label>
                 <input type="radio" name="q11" value="A" required> A) Consulting a pre-established set of moral rules.<br>
                 <input type="radio" name="q11" value="B"> B) Assessing the consequences of the particular act itself in that specific situation.<br>
                 <input type="radio" name="q11" value="C"> C) Evaluating the character of the person performing the act.<br>
                 <input type="radio" name="q11" value="D"> D) Determining if the act violates anyone's rights.
             </div>
             <div class="form-group">
                 <label>12. Rule-utilitarianism suggests an act is right if:</label>
                 <input type="radio" name="q12" value="A" required> A) It produces the best consequences in that specific instance.<br>
                 <input type="radio" name="q12" value="B"> B) It conforms to a set of rules whose general acceptance would produce the best consequences.<br>
                 <input type="radio" name="q12" value="C"> C) It is performed with a good intention, regardless of the rules.<br>
                 <input type="radio" name="q12" value="D"> D) It aligns with the agent's personal feelings.
             </div>
             <div class="form-group">
                 <label>13. A strength of utilitarianism mentioned in the text is its:</label>
                 <input type="radio" name="q13" value="A" required> A) Ability to easily resolve all complex moral dilemmas without calculation.<br>
                 <input type="radio" name="q13" value="B"> B) Focus on abstract principles disconnected from human well-being.<br>
                 <input type="radio" name="q13" value="C"> C) Provision of a single principle (utility) to potentially guide all actions.<br>
                 <input type="radio" name="q13" value="D"> D) Compatibility with all common-sense intuitions about justice.
             </div>
             <div class="form-group">
                 <label>14. The "problem of posterity" poses a challenge for ethical egoism because:</label>
                 <input type="radio" name="q14" value="A" required> A) Future generations cannot benefit the egoist currently acting.<br>
                 <input type="radio" name="q14" value="B"> B) Egoists inherently care more about the future than the present.<br>
                 <input type="radio" name="q14" value="C"> C) Utilitarianism forbids considering future generations.<br>
                 <input type="radio" name="q14" value="D"> D) Egoism requires maximizing happiness for the greatest number, including the unborn.
             </div>
             <div class="form-group">
                 <label>15. A common criticism of utilitarianism is that it might:</label>
                 <input type="radio" name="q15" value="A" required> A) Be too rigid in applying absolute rules.<br>
                 <input type="radio" name="q15" value="B"> B) Justify actions that seem intuitively immoral (like punishing the innocent) if they produce the greatest good.<br>
                 <input type="radio" name="q15" value="C"> C) Ignore the consequences of actions entirely.<br>
                 <input type="radio" name="q15" value="D"> D) Place too much emphasis on individual character.
             </div>
             <div class="form-group">
                 <label>16. The "No-Rest Objection" against utilitarianism suggests that:</label>
                 <input type="radio" name="q16" value="A" required> A) Utilitarianism promotes laziness.<br>
                 <input type="radio" name="q16" value="B"> B) It demands constant calculation and action to maximize utility, leaving no room for personal pursuits or rest.<br>
                 <input type="radio" name="q16" value="C"> C) Maximizing utility requires ignoring complex situations.<br>
                 <input type="radio" name="q16" value="D"> D) Only actions done spontaneously without thought can be moral.
             </div>
             <div class="form-group">
                 <label>17. Deontological ethics primarily bases morality on:</label>
                 <input type="radio" name="q17" value="A" required> A) The outcomes or consequences of actions.<br>
                 <input type="radio" name="q17" value="B"> B) Conforming to duties, rules, or principles.<br>
                 <input type="radio" name="q17" value="C"> C) The character and virtues of the moral agent.<br>
                 <input type="radio" name="q17" value="D"> D) The maximization of personal pleasure.
             </div>
             <div class="form-group">
                 <label>18. The Divine Command Theory (DCT) holds that morality:</label>
                 <input type="radio" name="q18" value="A" required> A) Originates from human reason alone.<br>
                 <input type="radio" name="q18" value="B"> B) Is based on the consequences of actions.<br>
                 <input type="radio" name="q18" value="C"> C) Originates from the commands or will of God.<br>
                 <input type="radio" name="q18" value="D"> D) Is relative to cultural norms.
             </div>
             <div class="form-group">
                 <label>19. A problem raised against the Divine Command Theory is the:</label>
                 <input type="radio" name="q19" value="A" required> A) Difficulty in calculating consequences.<br>
                 <input type="radio" name="q19" value="B"> B) Arbitrariness problem (could God command cruelty and make it right?).<br>
                 <input type="radio" name="q19" value="C"> C) Issue of conflicting virtues.<br>
                 <input type="radio" name="q19" value="D"> D) Inability to account for future generations.
             </div>
             <div class="form-group">
                 <label>20. Rights theory, particularly in the tradition of John Locke, posits that rights are:</label>
                 <input type="radio" name="q20" value="A" required> A) Granted by governments and can be easily taken away.<br>
                 <input type="radio" name="q20" value="B"> B) Based solely on maximizing utility for society.<br>
                 <input type="radio" name="q20" value="C"> C) Natural, universal, equal, and inalienable.<br>
                 <input type="radio" name="q20" value="D"> D) Dependent on an individual's character traits.
             </div>
             <div class="form-group">
                 <label>21. The correlativity of rights and duties means that:</label>
                 <input type="radio" name="q21" value="A" required> A) Rights exist independently of any duties.<br>
                 <input type="radio" name="q21" value="B"> B) One person's right often implies a corresponding duty on another person.<br>
                 <input type="radio" name="q21" value="C"> C) Duties are always more important than rights.<br>
                 <input type="radio" name="q21" value="D"> D) Only governments have duties related to rights.
             </div>
             <div class="form-group">
                 <label>22. Immanuel Kant's ethical theory is a prominent example of:</label>
                 <input type="radio" name="q22" value="A" required> A) Utilitarianism<br>
                 <input type="radio" name="q22" value="B"> B) Ethical egoism<br>
                 <input type="radio" name="q22" value="C"> C) Deontology<br>
                 <input type="radio" name="q22" value="D"> D) Virtue ethics
             </div>
             <div class="form-group">
                 <label>23. For Kant, the only thing good without qualification is:</label>
                 <input type="radio" name="q23" value="A" required> A) Happiness<br>
                 <input type="radio" name="q23" value="B"> B) Pleasure<br>
                 <input type="radio" name="q23" value="C"> C) A good will<br>
                 <input type="radio" name="q23" value="D"> D) Intelligence
             </div>
             <div class="form-group">
                 <label>24. A categorical imperative, according to Kant, is a command that:</label>
                 <input type="radio" name="q24" value="A" required> A) Depends on personal desires or goals (hypothetical).<br>
                 <input type="radio" name="q24" value="B"> B) Applies universally and necessarily, irrespective of personal desires.<br>
                 <input type="radio" name="q24" value="C"> C) Focuses on achieving the best consequences.<br>
                 <input type="radio" name="q24" value="D"> D) Is derived from religious texts.
             </div>
             <div class="form-group">
                 <label>25. Kant's first formulation of the categorical imperative (Principle of Universality) requires acting only according to maxims that:</label>
                 <input type="radio" name="q25" value="A" required> A) Produce the greatest happiness for the greatest number.<br>
                 <input type="radio" name="q25" value="B"> B) You could will to become universal laws without contradiction.<br>
                 <input type="radio" name="q25" value="C"> C) Align with God's commands.<br>
                 <input type="radio" name="q25" value="D"> D) Develop virtuous character traits.
             </div>
             <div class="form-group">
                 <label>26. Kant's distinction between perfect and imperfect duties means:</label>
                 <input type="radio" name="q26" value="A" required> A) Perfect duties are optional; imperfect duties are obligatory.<br>
                 <input type="radio" name="q26" value="B"> B) Perfect duties allow no exceptions (e.g., not lying); imperfect duties have flexibility (e.g., developing talents).<br>
                 <input type="radio" name="q26" value="C"> C) Perfect duties relate to consequences; imperfect duties relate to intentions.<br>
                 <input type="radio" name="q26" value="D"> D) Perfect duties are societal; imperfect duties are personal.
             </div>
             <div class="form-group">
                 <label>27. The second formulation of Kant's categorical imperative (Principle of Humanity) states that we should treat humanity:</label>
                 <input type="radio" name="q27" value="A" required> A) Solely as a means to achieve our goals.<br>
                 <input type="radio" name="q27" value="B"> B) Always as an end in itself, never merely as a means.<br>
                 <input type="radio" name="q27" value="C"> C) Based on the pleasure or pain produced.<br>
                 <input type="radio" name="q27" value="D"> D) According to societal conventions.
             </div>
             <div class="form-group">
                 <label>28. Kant's concept of autonomy emphasizes the importance of:</label>
                 <input type="radio" name="q28" value="A" required> A) Acting according to external authorities or influences (heteronomy).<br>
                 <input type="radio" name="q28" value="B"> B) The individual's capacity for self-governance through rational free choice.<br>
                 <input type="radio" name="q28" value="C"> C) Achieving the best possible outcomes for oneself.<br>
                 <input type="radio" name="q28" value="D"> D) Following one's emotional impulses.
             </div>
             <div class="form-group">
                 <label>29. A major criticism of Kant's ethics is its:</label>
                 <input type="radio" name="q29" value="A" required> A) Lack of clear principles.<br>
                 <input type="radio" name="q29" value="B"> B) Overemphasis on consequences.<br>
                 <input type="radio" name="q29" value="C"> C) Potential rigidity, especially in cases of conflicting duties (e.g., the inquiring murderer).<br>
                 <input type="radio" name="q29" value="D"> D) Failure to consider intentions.
             </div>
             <div class="form-group">
                 <label>30. W.D. Ross's theory attempts to address conflicts of duty through the concept of:</label>
                 <input type="radio" name="q30" value="A" required> A) Hedonic calculus<br>
                 <input type="radio" name="q30" value="B"> B) The veil of ignorance<br>
                 <input type="radio" name="q30" value="C"> C) Prima facie duties<br>
                 <input type="radio" name="q30" value="D"> D) The state of nature
             </div>
             <div class="form-group">
                 <label>31. According to Ross, a prima facie duty is one that:</label>
                 <input type="radio" name="q31" value="A" required> A) Is absolutely binding in all circumstances.<br>
                 <input type="radio" name="q31" value="B"> B) Is obligatory unless overridden by a stronger duty in a specific situation.<br>
                 <input type="radio" name="q31" value="C"> C) Is based solely on achieving good consequences.<br>
                 <input type="radio" name="q31" value="D"> D) Represents a character trait to be cultivated.
             </div>
             <div class="form-group">
                 <label>32. Which of the following is listed by Ross as a category of prima facie duty?</label>
                 <input type="radio" name="q32" value="A" required> A) Duty of maximizing pleasure<br>
                 <input type="radio" name="q32" value="B"> B) Duty of self-interest<br>
                 <input type="radio" name="q32" value="C"> C) Duty of fidelity (keeping promises)<br>
                 <input type="radio" name="q32" value="D"> D) Duty of following the law
             </div>
             <div class="form-group">
                 <label>33. Virtue ethics shifts the focus of ethics from actions/rules to:</label>
                 <input type="radio" name="q33" value="A" required> A) Consequences and utility maximization.<br>
                 <input type="radio" name="q33" value="B"> B) The character, dispositions, and virtues of the moral agent.<br>
                 <input type="radio" name="q33" value="C"> C) Divine commands and religious laws.<br>
                 <input type="radio" name="q33" value="D"> D) The analysis of moral language.
             </div>
             <div class="form-group">
                 <label>34. Aristotle's term for human flourishing or living well, often translated as happiness, is:</label>
                 <input type="radio" name="q34" value="A" required> A) Arete<br>
                 <input type="radio" name="q34" value="B"> B) Phronesis<br>
                 <input type="radio" name="q34" value="C"> C) Eudaimonia<br>
                 <input type="radio" name="q34" value="D"> D) Hedone
             </div>
             <div class="form-group">
                 <label>35. For Aristotle, moral virtue (arete) is typically found as:</label>
                 <input type="radio" name="q35" value="A" required> A) An extreme point of behavior.<br>
                 <input type="radio" name="q35" value="B"> B) A mean between two extremes (excess and deficiency).<br>
                 <input type="radio" name="q35" value="C"> C) Whatever produces the most pleasure.<br>
                 <input type="radio" name="q35" value="D"> D) Compliance with a divine command.
             </div>
             <div class="form-group">
                 <label>36. In Aristotle's ethics, developing virtues primarily occurs through:</label>
                 <input type="radio" name="q36" value="A" required> A) Intellectual study alone.<br>
                 <input type="radio" name="q36" value="B"> B) Divine grace.<br>
                 <input type="radio" name="q36" value="C"> C) Habituation and practice.<br>
                 <input type="radio" name="q36" value="D"> D) Following strict, exceptionless rules.
             </div>
             <div class="form-group">
                 <label>37. 'Phronesis' in Aristotelian ethics refers to:</label>
                 <input type="radio" name="q37" value="A" required> A) Theoretical wisdom about metaphysics.<br>
                 <input type="radio" name="q37" value="B"> B) Practical wisdom or the ability to discern the right course of action in specific situations.<br>
                 <input type="radio" name="q37" value="C"> C) The virtue of courage.<br>
                 <input type="radio" name="q37" value="D"> D) The pursuit of pleasure.
             </div>
             <div class="form-group">
                 <label>38. According to Aristotle, pleasure is:</label>
                 <input type="radio" name="q38" value="A" required> A) The ultimate goal of all moral action.<br>
                 <input type="radio" name="q38" value="B"> B) Morally bad and should be avoided.<br>
                 <input type="radio" name="q38" value="C"> C) A side-product or natural accompaniment of unimpeded activity, not the goal itself.<br>
                 <input type="radio" name="q38" value="D"> D) Only associated with base, physical activities.
             </div>
             <div class="form-group">
                 <label>39. Meta-ethics is concerned with:</label>
                 <input type="radio" name="q39" value="A" required> A) Prescribing which actions are right or wrong.<br>
                 <input type="radio" name="q39" value="B"> B) Developing virtuous character traits.<br>
                 <input type="radio" name="q39" value="C"> C) Analyzing the nature, meaning, and justification of moral judgments and terms.<br>
                 <input type="radio" name="q39" value="D"> D) Applying ethical theories to specific practical dilemmas.
             </div>
             <div class="form-group">
                 <label>40. Cognitivism in meta-ethics is the view that moral judgments:</label>
                 <input type="radio" name="q40" value="A" required> A) Express emotions or attitudes.<br>
                 <input type="radio" name="q40" value="B"> B) Are commands or prescriptions.<br>
                 <input type="radio" name="q40" value="C"> C) Express beliefs that can be true or false.<br>
                 <input type="radio" name="q40" value="D"> D) Are meaningless statements.
             </div>
             <div class="form-group">
                 <label>41. Non-cognitivism holds that moral judgments:</label>
                 <input type="radio" name="q41" value="A" required> A) Express beliefs about objective moral facts.<br>
                 <input type="radio" name="q41" value="B"> B) Cannot be true or false, often expressing emotions or commands.<br>
                 <input type="radio" name="q41" value="C"> C) Are always true by definition.<br>
                 <input type="radio" name="q41" value="D"> D) Are only made by irrational individuals.
             </div>
             <div class="form-group">
                 <label>42. Ethical Naturalism, a form of cognitivism, claims that moral properties are:</label>
                 <input type="radio" name="q42" value="A" required> A) Non-existent.<br>
                 <input type="radio" name="q42" value="B"> B) Identical or reducible to natural properties (e.g., psychological, biological).<br>
                 <input type="radio" name="q42" value="C"> C) Irreducible, non-natural properties.<br>
                 <input type="radio" name="q42" value="D"> D) Based only on cultural agreement.
             </div>
             <div class="form-group">
                 <label>43. Ethical Non-Naturalism asserts that moral properties (like 'goodness') are:</label>
                 <input type="radio" name="q43" value="A" required> A) Reducible to properties studied by natural sciences.<br>
                 <input type="radio" name="q43" value="B"> B) Commands issued by God.<br>
                 <input type="radio" name="q43" value="C"> C) Simple, unanalyzable, and not identical to natural properties.<br>
                 <input type="radio" name="q43" value="D"> D) Fictions created by society.
             </div>
             <div class="form-group">
                 <label>44. Mackie's 'Error Theory' is the view that:</label>
                 <input type="radio" name="q44" value="A" required> A) All moral judgments are true.<br>
                 <input type="radio" name="q44" value="B"> B) Moral judgments express non-cognitive states.<br>
                 <input type="radio" name="q44" value="C"> C) Moral judgments aim for truth but are systematically false because objective moral facts do not exist.<br>
                 <input type="radio" name="q44" value="D"> D) Some moral judgments are true, and some are false.
             </div>
             <div class="form-group">
                 <label>45. Emotivism (like A.J. Ayer's version) suggests that stating "Murder is wrong" is akin to:</label>
                 <input type="radio" name="q45" value="A" required> A) Stating a verifiable fact about murder.<br>
                 <input type="radio" name="q45" value="B"> B) Expressing a personal feeling or attitude, like saying "Boo to murder!"<br>
                 <input type="radio" name="q45" value="C"> C) Reporting a command from God.<br>
                 <input type="radio" name="q45" value="D"> D) Making a prediction about the consequences of murder.
             </div>
             <div class="form-group">
                 <label>46. The Frege-Geach problem challenges non-cognitivism by pointing out difficulties in explaining:</label>
                 <input type="radio" name="q46" value="A" required> A) How moral judgments motivate action.<br>
                 <input type="radio" name="q46" value="B"> B) The meaning of moral terms in simple assertions.<br>
                 <input type="radio" name="q46" value="C"> C) How moral terms function logically in complex sentences and arguments (e.g., conditionals).<br>
                 <input type="radio" name="q46" value="D"> D) Why people disagree about morality.
             </div>
             <div class="form-group">
                 <label>47. Moral Internalism is the view that there is a necessary connection between:</label>
                 <input type="radio" name="q47" value="A" required> A) Moral judgment and divine commands.<br>
                 <input type="radio" name="q47" value="B"> B) Moral judgment and societal approval.<br>
                 <input type="radio" name="q47" value="C"> C) Making a moral judgment and being motivated to act accordingly.<br>
                 <input type="radio" name="q47" value="D"> D) Beliefs and consequences.
             </div>
             <div class="form-group">
                 <label>48. Moral Externalism claims the connection between moral judgment and motivation is:</label>
                 <input type="radio" name="q48" value="A" required> A) Necessary and conceptual.<br>
                 <input type="radio" name="q48" value="B"> B) Contingent and external; one can judge something right without being motivated to do it.<br>
                 <input type="radio" name="q48" value="C"> C) Impossible.<br>
                 <input type="radio" name="q48" value="D"> D) Based solely on emotions.
             </div>
             <div class="form-group">
                 <label>49. The "Humean theory of motivation" posits that motivation requires:</label>
                 <input type="radio" name="q49" value="A" required> A) Only beliefs.<br>
                 <input type="radio" name="q49" value="B"> B) Only desires.<br>
                 <input type="radio" name="q49" value="C"> C) Both beliefs and desires.<br>
                 <input type="radio" name="q49" value="D"> D) Neither beliefs nor desires.
             </div>
             <div class="form-group">
                 <label>50. The overall aim of Chapter Two appears to be:</label>
                 <input type="radio" name="q50" value="A" required> A) To definitively prove which single ethical theory is correct.<br>
                 <input type="radio" name="q50" value="B"> B) To introduce students to the major types of ethical theories (teleological, deontological, virtue) and meta-ethics.<br>
                 <input type="radio" name="q50" value="C"> C) To focus solely on applying ethics to practical problems.<br>
                 <input type="radio" name="q50" value="D"> D) To argue that morality is entirely subjective and meaningless.
             </div>

            <button type="button" onclick="showReview()">Submit</button>
        </form>
        <div id="error-message" class="hidden">
            <p>Something went wrong. Please try again.</p>
        </div>
    </div>

    <div id="review-section" class="hidden">
        <h2>Review Your Answers</h2>
        <div id="review-content"></div>
        <button onclick="editForm()">Edit</button>
        <button onclick="downloadResponse()" id="download-response">Download My Response</button>
        <button onclick="confirmSubmission()">Confirm Submission</button>
    </div>

    <div id="submission-copy" class="hidden">
        <h2>Your Submitted Answers</h2>
        <div id="submission-content"></div>
        <button onclick="proceedToPassword()">Proceed</button>
    </div>

    <div id="password-section" class="hidden">
        <h1 id="success-message">Your response has been submitted</h1>
        <p>You can view your result (score) by entering the password.</p>
        <input type="password" id="password" placeholder="Enter password">
        <button onclick="checkPassword()">Submit</button>
        <p id="password-error" class="hidden">Incorrect password. Please try again.</p>
    </div>

    <div id="results" class="hidden">
        <h1>Quiz Results</h1>
        <p id="student-info"></p>
        <div id="answers"></div>
        <p id="score"></p>
        <button id="download-pdf" onclick="downloadPDF()">Download Results PDF</button>
    </div>

    <script>
        let quizData = null;
        let formData = null;
        const { jsPDF } = window.jspdf;
        const TOTAL_QUESTIONS = 50; // Total number of questions remains 50

        // Valid login credentials (Remains the same)
        const validCredentials = [
            { username: 'section19', password: '123' },
            { username: 'section20', password: '123' },
            { username: 'muzemuza', password: 'moh' },
            { username: 'section21', password: '123' }
            // Add more valid credentials as needed
        ];

        // **** NEW SET: Approaches to Ethics Questions ****
        const allQuestionsData = {
             q1: { text: 'Normative ethics is primarily concerned with:', choices: { A: "Analyzing the meaning of ethical terms like 'good' and 'right'.", B: 'Describing how people actually behave in moral situations.', C: 'Offering theories or accounts of the best way to live and evaluating actions systematically.', D: 'Studying the historical development of moral codes.' } },
             q2: { text: 'Teleological ethical theories determine the morality of an action based on its:', choices: { A: 'Adherence to universal moral rules.', B: 'Consequences or outcomes.', C: 'The intention or motive of the actor.', D: 'The virtues or character traits it demonstrates.' } },
             q3: { text: 'The phrase "the end justifies the means" is most characteristic of which type of ethical theory?', choices: { A: 'Deontological ethics', B: 'Virtue ethics', C: 'Teleological ethics', D: 'Meta-ethics' } },
             q4: { text: 'According to teleological theories, the moral quality of an action is dependent on:', choices: { A: 'Its conformity to divine commands.', B: 'The inherent nature of the act itself.', C: 'The nonmoral value it produces.', D: 'Its consistency when universalized.' } },
             q5: { text: 'A key difference between ethical egoism and utilitarianism is:', choices: { A: 'Ethical egoism focuses on consequences, while utilitarianism focuses on duties.', B: "Ethical egoism promotes the agent's own good, while utilitarianism promotes the greatest general good.", C: 'Ethical egoism is a deontological theory, while utilitarianism is teleological.', D: 'Ethical egoism considers pleasure, while utilitarianism considers only duty.' } },
             q6: { text: 'Psychological egoism is the view that:', choices: { A: 'People ought to act only in their self-interest.', B: 'People always act in ways they perceive to be in their own self-interest.', C: 'Selfishness is morally commendable.', D: 'Altruism is the primary motivator for all human actions.' } },
             q7: { text: 'The argument that connects psychological egoism to ethical egoism often relies on the principle:', choices: { A: '"The ends justify the means."', B: '"Treat others as you wish to be treated."', C: '"Ought implies can."', D: '"Act only on that maxim you can will as universal law."' } },
             q8: { text: 'Utilitarianism, as formulated by Bentham and Mill, is a form of:', choices: { A: 'Ethical egoism', B: 'Deontology', C: 'Virtue ethics', D: 'Ethical universalism (a type of teleological theory)' } },
             q9: { text: "Jeremy Bentham's utilitarianism emphasized maximizing pleasure based on its:", choices: { A: 'Quality and type (higher vs. lower).', B: 'Quantitative aspects (intensity, duration, certainty, etc.).', C: 'Adherence to traditional moral rules.', D: 'Source in divine revelation.' } },
             q10: { text: 'John Stuart Mill refined utilitarianism by arguing that:', choices: { A: 'All pleasures are equal in value.', B: 'The quantity of pleasure is the only factor that matters.', C: 'Some kinds of pleasure (intellectual, cultural) are qualitatively superior to others.', D: 'Utilitarian calculations are impossible to perform.' } },
             q11: { text: 'Act-utilitarianism determines the rightness of an action by:', choices: { A: 'Consulting a pre-established set of moral rules.', B: 'Assessing the consequences of the particular act itself in that specific situation.', C: 'Evaluating the character of the person performing the act.', D: "Determining if the act violates anyone's rights." } },
             q12: { text: 'Rule-utilitarianism suggests an act is right if:', choices: { A: 'It produces the best consequences in that specific instance.', B: 'It conforms to a set of rules whose general acceptance would produce the best consequences.', C: 'It is performed with a good intention, regardless of the rules.', D: "It aligns with the agent's personal feelings." } },
             q13: { text: 'A strength of utilitarianism mentioned in the text is its:', choices: { A: 'Ability to easily resolve all complex moral dilemmas without calculation.', B: 'Focus on abstract principles disconnected from human well-being.', C: 'Provision of a single principle (utility) to potentially guide all actions.', D: 'Compatibility with all common-sense intuitions about justice.' } },
             q14: { text: 'The "problem of posterity" poses a challenge for ethical egoism because:', choices: { A: 'Future generations cannot benefit the egoist currently acting.', B: 'Egoists inherently care more about the future than the present.', C: 'Utilitarianism forbids considering future generations.', D: 'Egoism requires maximizing happiness for the greatest number, including the unborn.' } },
             q15: { text: 'A common criticism of utilitarianism is that it might:', choices: { A: 'Be too rigid in applying absolute rules.', B: 'Justify actions that seem intuitively immoral (like punishing the innocent) if they produce the greatest good.', C: 'Ignore the consequences of actions entirely.', D: 'Place too much emphasis on individual character.' } },
             q16: { text: 'The "No-Rest Objection" against utilitarianism suggests that:', choices: { A: 'Utilitarianism promotes laziness.', B: 'It demands constant calculation and action to maximize utility, leaving no room for personal pursuits or rest.', C: 'Maximizing utility requires ignoring complex situations.', D: 'Only actions done spontaneously without thought can be moral.' } },
             q17: { text: 'Deontological ethics primarily bases morality on:', choices: { A: 'The outcomes or consequences of actions.', B: 'Conforming to duties, rules, or principles.', C: 'The character and virtues of the moral agent.', D: 'The maximization of personal pleasure.' } },
             q18: { text: 'The Divine Command Theory (DCT) holds that morality:', choices: { A: 'Originates from human reason alone.', B: 'Is based on the consequences of actions.', C: 'Originates from the commands or will of God.', D: 'Is relative to cultural norms.' } },
             q19: { text: 'A problem raised against the Divine Command Theory is the:', choices: { A: 'Difficulty in calculating consequences.', B: 'Arbitrariness problem (could God command cruelty and make it right?).', C: 'Issue of conflicting virtues.', D: 'Inability to account for future generations.' } },
             q20: { text: 'Rights theory, particularly in the tradition of John Locke, posits that rights are:', choices: { A: 'Granted by governments and can be easily taken away.', B: 'Based solely on maximizing utility for society.', C: 'Natural, universal, equal, and inalienable.', D: "Dependent on an individual's character traits." } },
             q21: { text: 'The correlativity of rights and duties means that:', choices: { A: 'Rights exist independently of any duties.', B: "One person's right often implies a corresponding duty on another person.", C: 'Duties are always more important than rights.', D: 'Only governments have duties related to rights.' } },
             q22: { text: "Immanuel Kant's ethical theory is a prominent example of:", choices: { A: 'Utilitarianism', B: 'Ethical egoism', C: 'Deontology', D: 'Virtue ethics' } },
             q23: { text: 'For Kant, the only thing good without qualification is:', choices: { A: 'Happiness', B: 'Pleasure', C: 'A good will', D: 'Intelligence' } },
             q24: { text: 'A categorical imperative, according to Kant, is a command that:', choices: { A: 'Depends on personal desires or goals (hypothetical).', B: 'Applies universally and necessarily, irrespective of personal desires.', C: 'Focuses on achieving the best consequences.', D: 'Is derived from religious texts.' } },
             q25: { text: "Kant's first formulation of the categorical imperative (Principle of Universality) requires acting only according to maxims that:", choices: { A: 'Produce the greatest happiness for the greatest number.', B: 'You could will to become universal laws without contradiction.', C: "Align with God's commands.", D: 'Develop virtuous character traits.' } },
             q26: { text: "Kant's distinction between perfect and imperfect duties means:", choices: { A: 'Perfect duties are optional; imperfect duties are obligatory.', B: 'Perfect duties allow no exceptions (e.g., not lying); imperfect duties have flexibility (e.g., developing talents).', C: 'Perfect duties relate to consequences; imperfect duties relate to intentions.', D: 'Perfect duties are societal; imperfect duties are personal.' } },
             q27: { text: "The second formulation of Kant's categorical imperative (Principle of Humanity) states that we should treat humanity:", choices: { A: 'Solely as a means to achieve our goals.', B: 'Always as an end in itself, never merely as a means.', C: 'Based on the pleasure or pain produced.', D: 'According to societal conventions.' } },
             q28: { text: "Kant's concept of autonomy emphasizes the importance of:", choices: { A: 'Acting according to external authorities or influences (heteronomy).', B: "The individual's capacity for self-governance through rational free choice.", C: 'Achieving the best possible outcomes for oneself.', D: "Following one's emotional impulses." } },
             q29: { text: "A major criticism of Kant's ethics is its:", choices: { A: 'Lack of clear principles.', B: 'Overemphasis on consequences.', C: 'Potential rigidity, especially in cases of conflicting duties (e.g., the inquiring murderer).', D: 'Failure to consider intentions.' } },
             q30: { text: "W.D. Ross's theory attempts to address conflicts of duty through the concept of:", choices: { A: 'Hedonic calculus', B: 'The veil of ignorance', C: 'Prima facie duties', D: 'The state of nature' } },
             q31: { text: 'According to Ross, a prima facie duty is one that:', choices: { A: 'Is absolutely binding in all circumstances.', B: 'Is obligatory unless overridden by a stronger duty in a specific situation.', C: 'Is based solely on achieving good consequences.', D: 'Represents a character trait to be cultivated.' } },
             q32: { text: 'Which of the following is listed by Ross as a category of prima facie duty?', choices: { A: 'Duty of maximizing pleasure', B: 'Duty of self-interest', C: 'Duty of fidelity (keeping promises)', D: 'Duty of following the law' } },
             q33: { text: 'Virtue ethics shifts the focus of ethics from actions/rules to:', choices: { A: 'Consequences and utility maximization.', B: 'The character, dispositions, and virtues of the moral agent.', C: 'Divine commands and religious laws.', D: 'The analysis of moral language.' } },
             q34: { text: "Aristotle's term for human flourishing or living well, often translated as happiness, is:", choices: { A: 'Arete', B: 'Phronesis', C: 'Eudaimonia', D: 'Hedone' } },
             q35: { text: 'For Aristotle, moral virtue (arete) is typically found as:', choices: { A: 'An extreme point of behavior.', B: 'A mean between two extremes (excess and deficiency).', C: 'Whatever produces the most pleasure.', D: 'Compliance with a divine command.' } },
             q36: { text: "In Aristotle's ethics, developing virtues primarily occurs through:", choices: { A: 'Intellectual study alone.', B: 'Divine grace.', C: 'Habituation and practice.', D: 'Following strict, exceptionless rules.' } },
             q37: { text: "'Phronesis' in Aristotelian ethics refers to:", choices: { A: 'Theoretical wisdom about metaphysics.', B: 'Practical wisdom or the ability to discern the right course of action in specific situations.', C: 'The virtue of courage.', D: 'The pursuit of pleasure.' } },
             q38: { text: 'According to Aristotle, pleasure is:', choices: { A: 'The ultimate goal of all moral action.', B: 'Morally bad and should be avoided.', C: 'A side-product or natural accompaniment of unimpeded activity, not the goal itself.', D: 'Only associated with base, physical activities.' } },
             q39: { text: 'Meta-ethics is concerned with:', choices: { A: 'Prescribing which actions are right or wrong.', B: 'Developing virtuous character traits.', C: 'Analyzing the nature, meaning, and justification of moral judgments and terms.', D: 'Applying ethical theories to specific practical dilemmas.' } },
             q40: { text: 'Cognitivism in meta-ethics is the view that moral judgments:', choices: { A: 'Express emotions or attitudes.', B: 'Are commands or prescriptions.', C: 'Express beliefs that can be true or false.', D: 'Are meaningless statements.' } },
             q41: { text: 'Non-cognitivism holds that moral judgments:', choices: { A: 'Express beliefs about objective moral facts.', B: 'Cannot be true or false, often expressing emotions or commands.', C: 'Are always true by definition.', D: 'Are only made by irrational individuals.' } },
             q42: { text: 'Ethical Naturalism, a form of cognitivism, claims that moral properties are:', choices: { A: 'Non-existent.', B: 'Identical or reducible to natural properties (e.g., psychological, biological).', C: 'Irreducible, non-natural properties.', D: 'Based only on cultural agreement.' } },
             q43: { text: "Ethical Non-Naturalism asserts that moral properties (like 'goodness') are:", choices: { A: 'Reducible to properties studied by natural sciences.', B: 'Commands issued by God.', C: 'Simple, unanalyzable, and not identical to natural properties.', D: 'Fictions created by society.' } },
             q44: { text: "Mackie's 'Error Theory' is the view that:", choices: { A: 'All moral judgments are true.', B: 'Moral judgments express non-cognitive states.', C: 'Moral judgments aim for truth but are systematically false because objective moral facts do not exist.', D: 'Some moral judgments are true, and some are false.' } },
             q45: { text: 'Emotivism (like A.J. Ayer\'s version) suggests that stating "Murder is wrong" is akin to:', choices: { A: 'Stating a verifiable fact about murder.', B: 'Expressing a personal feeling or attitude, like saying "Boo to murder!"', C: 'Reporting a command from God.', D: 'Making a prediction about the consequences of murder.' } },
             q46: { text: 'The Frege-Geach problem challenges non-cognitivism by pointing out difficulties in explaining:', choices: { A: 'How moral judgments motivate action.', B: 'The meaning of moral terms in simple assertions.', C: 'How moral terms function logically in complex sentences and arguments (e.g., conditionals).', D: 'Why people disagree about morality.' } },
             q47: { text: 'Moral Internalism is the view that there is a necessary connection between:', choices: { A: 'Moral judgment and divine commands.', B: 'Moral judgment and societal approval.', C: 'Making a moral judgment and being motivated to act accordingly.', D: 'Beliefs and consequences.' } },
             q48: { text: 'Moral Externalism claims the connection between moral judgment and motivation is:', choices: { A: 'Necessary and conceptual.', B: 'Contingent and external; one can judge something right without being motivated to do it.', C: 'Impossible.', D: 'Based solely on emotions.' } },
             q49: { text: 'The "Humean theory of motivation" posits that motivation requires:', choices: { A: 'Only beliefs.', B: 'Only desires.', C: 'Both beliefs and desires.', D: 'Neither beliefs nor desires.' } },
             q50: { text: 'The overall aim of Chapter Two appears to be:', choices: { A: 'To definitively prove which single ethical theory is correct.', B: 'To introduce students to the major types of ethical theories (teleological, deontological, virtue) and meta-ethics.', C: 'To focus solely on applying ethics to practical problems.', D: 'To argue that morality is entirely subjective and meaningless.' } }
        };

        // **** NEW SET: Correct answers mapped to letters (Approaches to Ethics Ch2) ****
        const correctAnswersMap = {
             q1: 'C', q2: 'B', q3: 'C', q4: 'C', q5: 'B',
             q6: 'B', q7: 'C', q8: 'D', q9: 'B', q10: 'C',
             q11: 'B', q12: 'B', q13: 'C', q14: 'A', q15: 'B',
             q16: 'B', q17: 'B', q18: 'C', q19: 'B', q20: 'C',
             q21: 'B', q22: 'C', q23: 'C', q24: 'B', q25: 'B',
             q26: 'B', q27: 'B', q28: 'B', q29: 'C', q30: 'C',
             q31: 'B', q32: 'C', q33: 'B', q34: 'C', q35: 'B',
             q36: 'C', q37: 'B', q38: 'C', q39: 'C', q40: 'C',
             q41: 'B', q42: 'B', q43: 'C', q44: 'C', q45: 'B',
             q46: 'C', q47: 'C', q48: 'B', q49: 'C', q50: 'B'
        };

        // --- Functions below mostly remain the same, but references to quiz content will use the new data ---

        function checkLogin() {
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('login-password').value.trim();
            const errorMessage = document.getElementById('login-error');
            const loginSection = document.getElementById('login-section');
            const quizForm = document.getElementById('quiz-form');

            const isValid = validCredentials.some(cred =>
                cred.username === username && cred.password === password
            );

            if (isValid) {
                errorMessage.classList.add('hidden');
                loginSection.classList.add('hidden');
                quizForm.classList.remove('hidden');
            } else {
                errorMessage.classList.remove('hidden');
            }
        }

        function showReview() {
            const form = document.getElementById('mcie-quiz');
            formData = new FormData(form);
            const data = Object.fromEntries(formData);

             // Check if all questions are answered
             let allAnswered = true;
             for (let i = 1; i <= TOTAL_QUESTIONS; i++) { // Loop uses TOTAL_QUESTIONS
                 if (!data[`q${i}`]) {
                     allAnswered = false;
                     break;
                 }
             }

             if (!data.name || !data.id_number || !data.section || !data.email || !data.phone || !allAnswered) {
                 alert('Please fill in all personal information and answer all questions before submitting.');
                 return; // Stop the function if validation fails
             }

            // Store quiz data temporarily
            quizData = {
                name: data.name,
                id_number: data.id_number,
                section: data.section,
                email: data.email,
                phone: data.phone,
                answers: {},
                questions: allQuestionsData // Use the updated structure
            };

            // Populate answers dynamically
            let reviewHTML = `
                <p><strong>Name:</strong> ${data.name}</p>
                <p><strong>ID Number:</strong> ${data.id_number}</p>
                <p><strong>Section:</strong> ${data.section}</p>
                <p><strong>Email:</strong> ${data.email}</p>
                <p><strong>Phone Number:</strong> ${data.phone}</p>
                <hr>
                <h3>Your Answers:</h3>
            `;

            for (let i = 1; i <= TOTAL_QUESTIONS; i++) { // Loop uses TOTAL_QUESTIONS
                const qKey = `q${i}`;
                const userAnswer = data[qKey];
                quizData.answers[qKey] = userAnswer; // Store answer
                const questionInfo = allQuestionsData[qKey]; // Use updated data
                const answerText = questionInfo.choices[userAnswer] || 'Not Answered';
                reviewHTML += `<p><strong>Question ${i}:</strong> ${questionInfo.text}<br>Your answer: ${userAnswer}) ${answerText}</p>`;
            }

            // Display review content
            const reviewContent = document.getElementById('review-content');
            reviewContent.innerHTML = reviewHTML;

            // Show review section
            document.getElementById('quiz-form').classList.add('hidden');
            document.getElementById('review-section').classList.remove('hidden');
        }

        function editForm() {
            document.getElementById('review-section').classList.add('hidden');
            document.getElementById('quiz-form').classList.remove('hidden');
        }

        function downloadResponse() {
            if (!quizData) return;

            const doc = new jsPDF();
            let y = 10;
            const pageHeight = doc.internal.pageSize.height;
            const pageWidth = doc.internal.pageSize.width;
            const margin = 10;
            const effectiveWidth = pageWidth - margin * 2;


            doc.setFontSize(16);
            doc.text('Approaches to Ethics Quiz Response - Chapter 2', pageWidth / 2, y, { align: 'center' }); // Updated Title
            y += 10;

            doc.setFontSize(12);
            doc.text(`Name: ${quizData.name}`, margin, y); y += 7;
            doc.text(`ID: ${quizData.id_number}`, margin, y); y += 7;
            doc.text(`Section: ${quizData.section}`, margin, y); y += 7;
            doc.text(`Email: ${quizData.email}`, margin, y); y += 7;
            doc.text(`Phone: ${quizData.phone}`, margin, y); y += 10;

            for (let i = 1; i <= TOTAL_QUESTIONS; i++) { // Loop uses TOTAL_QUESTIONS
                 const qKey = `q${i}`;
                 const question = quizData.questions[qKey];
                 const userAnswer = quizData.answers[qKey];
                 const answerText = question.choices[userAnswer] || 'Not Answered';
                 const questionText = question.text;

                 // Estimate space needed for the question + answer
                 const questionLines = doc.splitTextToSize(`Question ${i}: ${questionText}`, effectiveWidth);
                 const answerLines = doc.splitTextToSize(`Your answer: ${userAnswer}) ${answerText}`, effectiveWidth);
                 const spaceNeeded = (questionLines.length * 5) + 2 + (answerLines.length * 5) + 5; // Estimate lines * line height + spacing

                 if (y + spaceNeeded > pageHeight - margin) { // Check if content fits
                    doc.addPage();
                    y = margin;
                 }

                doc.setFont('helvetica', 'bold');
                doc.text(questionLines, margin, y);
                y += (questionLines.length * 5) + 2; // Adjust spacing based on lines
                doc.setFont('helvetica', 'normal');

                if (y > pageHeight - margin) { doc.addPage(); y = margin; } // Re-check just for answer part

                doc.text(answerLines, margin, y);
                y += (answerLines.length * 5) + 5; // Add space after the answer

            }

            doc.save(`approaches_ethics_ch2_quiz_response_${quizData.id_number}.pdf`); // Updated filename
        }

        // --- MODIFIED: Sends data to your backend ---
        async function confirmSubmission() {
            if (confirm('Are you sure you want to submit your answers?')) {
                if (!quizData || !formData) {
                     console.error("Quiz data or form data is missing.");
                     alert("Error: Cannot submit. Please try filling the form again.");
                     editForm(); // Go back to edit
                     return;
                }

                const data = Object.fromEntries(formData); // Use the stored formData

                // Calculate score
                let score = 0;
                for (let i = 1; i <= TOTAL_QUESTIONS; i++) { // Loop uses TOTAL_QUESTIONS
                    const qKey = `q${i}`;
                    if (data[qKey] === correctAnswersMap[qKey]) { // Use updated map
                        score++;
                    }
                }

                // Update quizData with score
                quizData.score = score;

                // Prepare data for YOUR backend
                const submissionData = {
                    name: data.name,
                    id_number: data.id_number,
                    section: data.section,
                    email: data.email,
                    phone: data.phone,
                    score: score,
                    totalQuestions: TOTAL_QUESTIONS,
                    quizTitle: "Approaches to Ethics Quiz - Chapter 2", // **** UPDATED TITLE ****
                    submittedAt: new Date().toISOString()
                    // Add individual answers if needed by backend
                    // answers: quizData.answers
                };

                try {
                    // Show "Submitting..." message or spinner here if desired

                    // --- MODIFIED FETCH CALL ---
                    const response = await fetch('/submit-quiz', { // Point to your backend endpoint
                        method: 'POST',
                        body: JSON.stringify(submissionData), // Send the data as JSON
                        headers: {
                            'Accept': 'application/json',
                            'Content-Type': 'application/json' // Important Header!
                        }
                    });
                    // --- END MODIFIED FETCH CALL ---

                    if (response.ok) {
                        // --- SUCCESS HANDLING (From YOUR backend) ---
                        const result = await response.json(); // Assuming your backend sends JSON back
                        console.log("Submission successful:", result);

                        // Show submission copy (Same as before)
                        const submissionContent = document.getElementById('submission-content');
                         let submissionHTML = `
                            <p><strong>Name:</strong> ${quizData.name}</p>
                            <p><strong>ID Number:</strong> ${quizData.id_number}</p>
                            <p><strong>Section:</strong> ${quizData.section}</p>
                            <p><strong>Email:</strong> ${quizData.email}</p>
                            <p><strong>Phone Number:</strong> ${quizData.phone}</p>
                            <hr>
                            <h3>Submitted Answers:</h3>
                        `;
                         for (let i = 1; i <= TOTAL_QUESTIONS; i++) { // Loop uses TOTAL_QUESTIONS
                             const qKey = `q${i}`;
                             const questionInfo = quizData.questions[qKey]; // Use updated data
                             const userAnswer = quizData.answers[qKey];
                             const answerText = questionInfo.choices[userAnswer] || 'Not Answered';
                             submissionHTML += `<p><strong>Question ${i}:</strong> ${questionInfo.text}<br>Your answer: ${userAnswer}) ${answerText}</p>`;
                         }
                        submissionContent.innerHTML = submissionHTML;

                        document.getElementById('review-section').classList.add('hidden');
                        document.getElementById('submission-copy').classList.remove('hidden');
                        // --- END SUCCESS HANDLING ---

                    } else {
                        // --- ERROR HANDLING (From YOUR backend) ---
                        let errorMsg = `Submission failed with status: ${response.status}`;
                        try {
                            const errorData = await response.json();
                            errorMsg = errorData.error || errorData.message || errorMsg;
                        } catch(e) { /* Ignore if response isn't JSON */ }

                        console.error('Backend submission error:', errorMsg);
                        document.getElementById('error-message').innerHTML = `<p>Submission failed: ${errorMsg}. Please try again.</p>`;
                        document.getElementById('error-message').classList.remove('hidden');
                        document.getElementById('review-section').classList.add('hidden');
                        // editForm(); // Optionally go back to edit
                        // --- END ERROR HANDLING ---
                    }
                } catch (error) {
                     // --- NETWORK/OTHER ERROR HANDLING ---
                    console.error('Network/Fetch error:', error);
                    document.getElementById('error-message').innerHTML = `<p>An network error occurred during submission. Please check your connection and try again.</p>`;
                    document.getElementById('error-message').classList.remove('hidden');
                    document.getElementById('review-section').classList.add('hidden');
                    // editForm(); // Optionally go back to edit
                    // --- END NETWORK ERROR HANDLING ---
                } finally {
                     // Hide "Submitting..." message or spinner here
                }
            }
        }


        function proceedToPassword() {
            document.getElementById('submission-copy').classList.add('hidden');
            document.getElementById('password-section').classList.remove('hidden');
        }

        function checkPassword() {
            const passwordInput = document.getElementById('password').value;
            const correctPassword = 'password'; // Keep the simple password
            const errorMessage = document.getElementById('password-error');
            const passwordSection = document.getElementById('password-section');
            const results = document.getElementById('results');

            if (passwordInput === correctPassword) {
                errorMessage.classList.add('hidden');
                passwordSection.classList.add('hidden');
                results.classList.remove('hidden');
                displayResults();
            } else {
                errorMessage.classList.remove('hidden');
            }
        }

        function displayResults() {
            if (!quizData) {
                document.getElementById('results').innerHTML = '<p>Error: No quiz data found. Please complete the quiz first.</p>';
                return;
            }

             // Combine correct answer letter with full text for display
             const displayCorrectAnswers = {};
             for(let i = 1; i <= TOTAL_QUESTIONS; i++) { // Loop uses TOTAL_QUESTIONS
                 const qKey = `q${i}`;
                 const correctLetter = correctAnswersMap[qKey]; // Use updated map
                 const correctText = allQuestionsData[qKey].choices[correctLetter]; // Use updated data
                 displayCorrectAnswers[qKey] = `${correctLetter}) ${correctText}`; // Changed format slightly
             }


            document.getElementById('student-info').innerHTML = `<strong>Name:</strong> ${quizData.name}<br><strong>ID:</strong> ${quizData.id_number}<br><strong>Section:</strong> ${quizData.section}<br><strong>Email:</strong> ${quizData.email}<br><strong>Phone:</strong> ${quizData.phone}`;

            const answersDiv = document.getElementById('answers');
            let answersHTML = '<h3>Detailed Results:</h3>';

            for (let i = 1; i <= TOTAL_QUESTIONS; i++) { // Loop uses TOTAL_QUESTIONS
                 const qKey = `q${i}`;
                 const question = quizData.questions[qKey]; // Use updated data
                 const userAnswer = quizData.answers[qKey];
                 const userAnswerText = question.choices[userAnswer] || 'Not Answered';
                 const isCorrect = userAnswer === correctAnswersMap[qKey]; // Use updated map

                 answersHTML += `
                    <div class="question-result">
                        <p><strong>Question ${i}:</strong> ${question.text}</p>
                        <div class="choices" style="font-size:0.9em; margin-left: 15px;">
                            <p>A) ${question.choices.A}</p>
                            <p>B) ${question.choices.B}</p>
                            <p>C) ${question.choices.C}</p>
                            <p>D) ${question.choices.D}</p>
                        </div>
                        <p>Your answer: ${userAnswer}) ${userAnswerText} ${isCorrect ? '<span style="color:green; font-weight:bold;">(Correct)</span>' : '<span style="color:red; font-weight:bold;">(Incorrect)</span>'}</p>
                        ${!isCorrect ? `<p style="color:blue;">Correct answer: ${displayCorrectAnswers[qKey]}</p>` : ''}
                    </div>
                `;
            }
            answersDiv.innerHTML = answersHTML;


            document.getElementById('score').textContent = `Final Score: ${quizData.score} / ${TOTAL_QUESTIONS}`;
        }

        function downloadPDF() {
            if (!quizData) return;

            const doc = new jsPDF();
            let y = 10;
            const pageHeight = doc.internal.pageSize.height;
            const pageWidth = doc.internal.pageSize.width;
            const margin = 10;
            const effectiveWidth = pageWidth - margin * 2;

             // Combine correct answer letter with full text for display
             const displayCorrectAnswers = {};
             for(let i = 1; i <= TOTAL_QUESTIONS; i++) { // Loop uses TOTAL_QUESTIONS
                 const qKey = `q${i}`;
                 const correctLetter = correctAnswersMap[qKey]; // Use updated map
                 const correctText = allQuestionsData[qKey].choices[correctLetter]; // Use updated data
                 displayCorrectAnswers[qKey] = `${correctLetter}) ${correctText}`;
             }

            doc.setFontSize(16);
            doc.text('Approaches to Ethics Quiz Results - Chapter 2', pageWidth / 2, y, { align: 'center' }); // Updated Title
            y += 10;

            doc.setFontSize(12);
            doc.text(`Name: ${quizData.name}`, margin, y); y += 7;
            doc.text(`ID: ${quizData.id_number}`, margin, y); y += 7;
            doc.text(`Section: ${quizData.section}`, margin, y); y += 7;
            doc.text(`Email: ${quizData.email}`, margin, y); y += 7;
            doc.text(`Phone: ${quizData.phone}`, margin, y); y += 10;

            doc.setFont('helvetica', 'bold');
            doc.text(`Final Score: ${quizData.score} / ${TOTAL_QUESTIONS}`, pageWidth / 2, y, { align: 'center' });
            y += 10;
            doc.setFont('helvetica', 'normal');


            for (let i = 1; i <= TOTAL_QUESTIONS; i++) { // Loop uses TOTAL_QUESTIONS
                 const qKey = `q${i}`;
                 const question = quizData.questions[qKey]; // Use updated data
                 const userAnswer = quizData.answers[qKey];
                 const userAnswerText = question.choices[userAnswer] || 'Not Answered';
                 const isCorrect = userAnswer === correctAnswersMap[qKey]; // Use updated map
                 const questionText = question.text;
                 const correctAnswerFull = displayCorrectAnswers[qKey];

                 // Estimate space needed
                 const qLines = doc.splitTextToSize(`Question ${i}: ${questionText}`, effectiveWidth);
                 const choicesLines = 4 * 5; // Estimate for 4 choices
                 const yourAnsLines = doc.splitTextToSize(`Your answer: ${userAnswer}) ${userAnswerText} ${isCorrect ? '(Correct)' : '(Incorrect)'}`, effectiveWidth);
                 const correctAnsLines = isCorrect ? 0 : doc.splitTextToSize(`Correct answer: ${correctAnswerFull}`, effectiveWidth).length * 5;
                 const spaceNeeded = (qLines.length * 5) + 2 + choicesLines + 7 + (yourAnsLines.length * 5) + 7 + correctAnsLines + 5;

                 if (y + spaceNeeded > pageHeight - margin) { // Check if content fits
                    doc.addPage();
                    y = margin;
                }

                doc.setFont('helvetica', 'bold');
                doc.text(qLines, margin, y);
                y += (qLines.length * 5) + 2; // Adjust spacing
                doc.setFont('helvetica', 'normal');

                if (y > pageHeight - margin * 3) { doc.addPage(); y = margin; } // Check space for choices/answers

                doc.setFontSize(10); // Slightly smaller for choices if needed
                doc.text(`  A) ${question.choices.A}`, margin + 5, y); y += 5;
                doc.text(`  B) ${question.choices.B}`, margin + 5, y); y += 5;
                doc.text(`  C) ${question.choices.C}`, margin + 5, y); y += 5;
                doc.text(`  D) ${question.choices.D}`, margin + 5, y); y += 7;
                doc.setFontSize(12); // Reset font size

                if (y > pageHeight - margin * 2) { doc.addPage(); y = margin; } // Check space for answers

                doc.text(`Your answer: ${userAnswer}) ${userAnswerText} ${isCorrect ? '(Correct)' : '(Incorrect)'}`, margin, y); y += 7;

                if (!isCorrect) {
                    doc.setTextColor(0, 0, 255); // Blue for correct answer when user was wrong
                    doc.text(`Correct answer: ${correctAnswerFull}`, margin, y); y += 7;
                    doc.setTextColor(0, 0, 0); // Reset color
                }
                y += 5; // Add space between questions

            }

            // Add score again at the end if needed, especially if it spans pages
            if (y > pageHeight - margin) { doc.addPage(); y = margin; }
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(14);
            doc.text(`Final Score: ${quizData.score} / ${TOTAL_QUESTIONS}`, pageWidth / 2, y, { align: 'center' });

            doc.save(`approaches_ethics_ch2_quiz_results_${quizData.id_number}.pdf`); // Updated filename
        }
    </script>
</body>
</html>
