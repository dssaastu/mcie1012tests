<!DOCTYPE html>
<html lang="en">
<head>
    <!-- IMPORTANT: Make sure your text editor saves this file with UTF-8 Encoding! -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Moral and Citizenship Education Quiz - Chapter 5</title> <!-- Updated Title -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input[type="text"], input[type="email"], input[type="tel"], input[type="password"] { width: 100%; padding: 8px; box-sizing: border-box; }
        input[type="radio"] { margin-right: 5px; }
        button { padding: 10px 20px; background-color: #007bff; color: white; border: none; cursor: pointer; margin-right: 10px; border-radius: 5px; }
        button:hover { background-color: #0056b3; }
        .hidden { display: none; }
        #error-message, #password-error, #login-error { color: red; font-size: 1.2em; text-align: center; }
        #success-message { color: green; font-size: 1.2em; text-align: center; }
        #results, #review-section, #submission-copy { margin-top: 20px; text-align: left; border: 1px solid #ccc; padding: 15px; border-radius: 5px; background-color: #f9f9f9;}
        #password-section, #login-section { text-align: center; max-width: 400px; margin: 20px auto; padding: 20px; border: 1px solid #ccc; border-radius: 5px; background-color: #f9f9f9;}
        #password-section input[type="password"], #login-section input[type="text"], #login-section input[type="password"] { width: calc(100% - 18px); }
        .question-result { margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid #eee; }
        #download-pdf, #download-response { margin-top: 10px; }
        #score { font-weight: bold; text-align: center; color: green; font-size: 1.4em; margin-top: 20px; }
        #review-section h2, #submission-copy h2, #results h1 { margin-bottom: 15px; text-align: center; color: #007bff;}
        #review-section button, #submission-copy button, #password-section button, #login-section button, #results button { margin-top: 15px; }
        .choices p { margin: 2px 0 2px 20px; }
    </style>
</head>
<body>
    <div id="login-section">
        <h1>Login to Access Quiz</h1>
        <div class="form-group">
            <label for="username">Username:</label>
            <input type="text" id="username" placeholder="Enter username" required>
        </div>
        <div class="form-group">
            <label for="login-password">Password:</label>
            <input type="password" id="login-password" placeholder="Enter password" required>
        </div>
        <button onclick="checkLogin()">Login</button>
        <p id="login-error" class="hidden">Incorrect username or password. Please try again.</p>
    </div>

    <div id="quiz-form" class="hidden">
        <h1>Moral and Citizenship Education Quiz - Chapter 5</h1> <!-- Updated Title -->
        <form id="mcie-quiz" method="POST">
            <!-- Student Information -->
            <div class="form-group">
                <label for="name">Name:</label>
                <input type="text" id="name" name="name" required>
            </div>
            <div class="form-group">
                <label for="id_number">ID Number:</label>
                <input type="text" id="id_number" name="id_number" required>
            </div>
            <div class="form-group">
                <label for="section">Section:</label>
                <input type="text" id="section" name="section" required>
            </div>
            <div class="form-group">
                <label for="email">Email:</label>
                <input type="email" id="email" name="email" required>
            </div>
            <div class="form-group">
                <label for="phone">Phone Number:</label>
                <input type="tel" id="phone" name="phone" required>
            </div>

            <!-- MCIE Multiple-Choice Questions (Chapter 5 SET - 50 Questions) -->
            <div class="form-group">
                 <label>1. In a political sense, a constitution primarily signifies:</label>
                 <input type="radio" name="q1" value="A" required> A) The physical health of the head of state.<br>
                 <input type="radio" name="q1" value="B"> B) The fundamental law and framework of the state.<br>
                 <input type="radio" name="q1" value="C"> C) The platform of the ruling political party.<br>
                 <input type="radio" name="q1" value="D"> D) The economic structure of a country.
             </div>
             <div class="form-group">
                 <label>2. Constitutionalism implies that:</label>
                 <input type="radio" name="q2" value="A" required> A) A country possesses a written constitution document.<br>
                 <input type="radio" name="q2" value="B"> B) Government powers are limited and exercised according to the rule of law.<br>
                 <input type="radio" name="q2" value="C"> C) The constitution can be easily changed by the ruling party.<br>
                 <input type="radio" name="q2" value="D"> D) The military is the supreme authority.
             </div>
             <div class="form-group">
                 <label>3. Which feature highlights that a constitution provides the foundational principles upon which other laws are built?</label>
                 <input type="radio" name="q3" value="A" required> A) Permanency<br>
                 <input type="radio" name="q3" value="B"> B) Generality<br>
                 <input type="radio" name="q3" value="C"> C) Supremacy<br>
                 <input type="radio" name="q3" value="D"> D) Codification
             </div>
             <div class="form-group">
                 <label>4. The feature of 'supremacy' means a constitution:</label>
                 <input type="radio" name="q4" value="A" required> A) Is easily amended.<br>
                 <input type="radio" name="q4" value="B"> B) Takes precedence over all other laws.<br>
                 <input type="radio" name="q4" value="C"> C) Applies only to government officials.<br>
                 <input type="radio" name="q4" value="D"> D) Is primarily composed of traditions.
             </div>
             <div class="form-group">
                 <label>5. A constitution that outlines specific processes for its amendment, often requiring more than a simple majority vote, is classified as:</label>
                 <input type="radio" name="q5" value="A" required> A) Flexible<br>
                 <input type="radio" name="q5" value="B"> B) Unitary<br>
                 <input type="radio" name="q5" value="C"> C) Rigid<br>
                 <input type="radio" name="q5" value="D"> D) Nominal
             </div>
             <div class="form-group">
                 <label>6. A constitution whose rules and principles largely correspond with the actual practices of government and citizens is termed:</label>
                 <input type="radio" name="q6" value="A" required> A) Nominal<br>
                 <input type="radio" name="q6" value="B"> B) Flexible<br>
                 <input type="radio" name="q6" value="C"> C) Unwritten<br>
                 <input type="radio" name="q6" value="D"> D) Effective
             </div>
             <div class="form-group">
                 <label>7. A key purpose of a constitution is to serve as a framework for government, meaning it:</label>
                 <input type="radio" name="q7" value="A" required> A) Details every single law needed.<br>
                 <input type="radio" name="q7" value="B"> B) Organizes government operations and outlines powers/functions.<br>
                 <input type="radio" name="q7" value="C"> C) Guarantees economic prosperity.<br>
                 <input type="radio" name="q7" value="D"> D) Can be ignored by the executive branch.
             </div>
             <div class="form-group">
                 <label>8. Constitutionalism ensures government actions are legitimate by checking if they are:</label>
                 <input type="radio" name="q8" value="A" required> A) Popular with the majority.<br>
                 <input type="radio" name="q8" value="B"> B) Economically efficient.<br>
                 <input type="radio" name="q8" value="C"> C) In accordance with pre-determined laws and rules.<br>
                 <input type="radio" name="q8" value="D"> D) Supported by the military.
             </div>
             <div class="form-group">
                 <label>9. Prior to 1931, Ethiopian constitutional tradition relied significantly on documents like:</label>
                 <input type="radio" name="q9" value="A" required> A) The Universal Declaration of Human Rights.<br>
                 <input type="radio" name="q9" value="B"> B) The Magna Carta.<br>
                 <input type="radio" name="q9" value="C"> C) The Kebra Nagast and Fetha Negest.<br>
                 <input type="radio" name="q9" value="D"> D) The Napoleonic Code.
             </div>
             <div class="form-group">
                 <label>10. The Fetha Negest served as a source for which types of law in traditional Ethiopia?</label>
                 <input type="radio" name="q10" value="A" required> A) Only religious law.<br>
                 <input type="radio" name="q10" value="B"> B) Only criminal law.<br>
                 <input type="radio" name="q10" value="C"> C) Constitutional, civil, and criminal law.<br>
                 <input type="radio" name="q10" value="D"> D) Only international law.
             </div>
             <div class="form-group">
                 <label>11. The primary source of legitimacy emphasized in the Kebra Nagast for Ethiopian rulers was:</label>
                 <input type="radio" name="q11" value="A" required> A) Military conquest.<br>
                 <input type="radio" name="q11" value="B"> B) Popular election.<br>
                 <input type="radio" name="q11" value="C"> C) Descent from the Solomonic dynasty.<br>
                 <input type="radio" name="q11" value="D"> D) Economic control.
             </div>
             <div class="form-group">
                 <label>12. A major internal factor leading to the 1931 Constitution was Emperor Haile Selassie's desire to:</label>
                 <input type="radio" name="q12" value="A" required> A) Increase the power of the regional nobility.<br>
                 <input type="radio" name="q12" value="B"> B) Centralize state power and reduce the influence of traditional nobles.<br>
                 <input type="radio" name="q12" value="C"> C) Establish a federal system.<br>
                 <input type="radio" name="q12" value="D"> D) Adopt socialist principles.
             </div>
             <div class="form-group">
                 <label>13. The 1955 Revised Constitution was partly influenced by:</label>
                 <input type="radio" name="q13" value="A" required> A) The Italian occupation's success.<br>
                 <input type="radio" name="q13" value="B"> B) The federation of Ethiopia and Eritrea.<br>
                 <input type="radio" name="q13" value="C"> C) The decline of the monarchy's power.<br>
                 <input type="radio" name="q13" value="D"> D) A shift to a multi-party system.
             </div>
             <div class="form-group">
                 <label>14. A key difference introduced in the 1987 PDRE Constitution compared to imperial ones was:</label>
                 <input type="radio" name="q14" value="A" required> A) The strengthening of the Emperor's divine right.<br>
                 <input type="radio" name="q14" value="B"> B) The formal separation of state and religion (secularism).<br>
                 <input type="radio" name="q14" value="C"> C) The establishment of a federal structure.<br>
                 <input type="radio" name="q14" value="D"> D) The guarantee of multi-party elections.
             </div>
             <div class="form-group">
                 <label>15. The 1995 FDRE Constitution allocates approximately how much of its content to rights?</label>
                 <input type="radio" name="q15" value="A" required> A) One-tenth<br>
                 <input type="radio" name="q15" value="B"> B) One-half<br>
                 <input type="radio" name="q15" value="C"> C) One-third<br>
                 <input type="radio" name="q15" value="D"> D) Three-quarters
             </div>
             <div class="form-group">
                 <label>16. A defining feature of the 1995 FDRE Constitution, distinguishing it significantly from previous ones, is:</label>
                 <input type="radio" name="q16" value="A" required> A) The concentration of all power in the executive.<br>
                 <input type="radio" name="q16" value="B"> B) The establishment of a federal structure based on nations, nationalities, and peoples.<br>
                 <input type="radio" name="q16" value="C"> C) The declaration of Ethiopia as a religious state.<br>
                 <input type="radio" name="q16" value="D"> D) The abolition of all human rights provisions.
             </div>
             <div class="form-group">
                 <label>17. The word 'democracy' originates from Greek words meaning:</label>
                 <input type="radio" name="q17" value="A" required> A) Rule by the wealthy.<br>
                 <input type="radio" name="q17" value="B"> B) Rule by the knowledgeable.<br>
                 <input type="radio" name="q17" value="C"> C) Rule by the people.<br>
                 <input type="radio" name="q17" value="D"> D) Rule by the priests.
             </div>
             <div class="form-group">
                 <label>18. Joseph Schumpeter defined democracy as an "institutional arrangement for arriving at political decisions" through:</label>
                 <input type="radio" name="q18" value="A" required> A) Consensus among elites.<br>
                 <input type="radio" name="q18" value="B"> B) A competitive struggle for the people's vote.<br>
                 <input type="radio" name="q18" value="C"> C) Divine appointment.<br>
                 <input type="radio" name="q18" value="D"> D) Hereditary succession.
             </div>
             <div class="form-group">
                 <label>19. Direct democracy involves decision-making by:</label>
                 <input type="radio" name="q19" value="A" required> A) Elected representatives.<br>
                 <input type="radio" name="q19" value="B"> B) A single authoritarian leader.<br>
                 <input type="radio" name="q19" value="C"> C) The entire body of citizens directly.<br>
                 <input type="radio" name="q19" value="D"> D) An independent judiciary.
             </div>
             <div class="form-group">
                 <label>20. Which is a core value of democracy, relating to fairness in distributing benefits/burdens and correcting wrongs?</label>
                 <input type="radio" name="q20" value="A" required> A) Liberty<br>
                 <input type="radio" name="q20" value="B"> B) Equality<br>
                 <input type="radio" name="q20" value="C"> C) Justice<br>
                 <input type="radio" name="q20" value="D"> D) Sovereignty
             </div>
             <div class="form-group">
                 <label>21. Political equality primarily implies:</label>
                 <input type="radio" name="q21" value="A" required> A) Equal economic outcomes for all.<br>
                 <input type="radio" name="q21" value="B"> B) Equal political rights, such as the right to vote (one person, one vote).<br>
                 <input type="radio" name="q21" value="C"> C) Identical political opinions among citizens.<br>
                 <input type="radio" name="q21" value="D"> D) The absence of political parties.
             </div>
             <div class="form-group">
                 <label>22. The principle that ultimate political authority rests with the people is known as:</label>
                 <input type="radio" name="q22" value="A" required> A) Rule of Law<br>
                 <input type="radio" name="q22" value="B"> B) Separation of Powers<br>
                 <input type="radio" name="q22" value="C"> C) Popular Sovereignty<br>
                 <input type="radio" name="q22" value="D"> D) Constitutional Supremacy
             </div>
             <div class="form-group">
                 <label>23. The principle requiring government to act according to clear, objective, publicly disclosed laws, and ensuring equality before the law, is:</label>
                 <input type="radio" name="q23" value="A" required> A) Secularism<br>
                 <input type="radio" name="q23" value="B"> B) Rule of Law<br>
                 <input type="radio" name="q23" value="C"> C) Majority Rule<br>
                 <input type="radio" name="q23" value="D"> D) Federalism
             </div>
             <div class="form-group">
                 <label>24. Secularism in a democratic context primarily means:</label>
                 <input type="radio" name="q24" value="A" required> A) The government must promote atheism.<br>
                 <input type="radio" name="q24" value="B"> B) Religion is banned from public life.<br>
                 <input type="radio" name="q24" value="C"> C) Separation of state institutions and religious institutions/affairs.<br>
                 <input type="radio" name="q24" value="D"> D) All citizens must belong to the same religion.
             </div>
             <div class="form-group">
                 <label>25. The division of governmental power among legislative, executive, and judicial branches is the principle of:</label>
                 <input type="radio" name="q25" value="A" required> A) Popular Sovereignty<br>
                 <input type="radio" name="q25" value="B"> B) Federalism<br>
                 <input type="radio" name="q25" value="C"> C) Separation of Powers<br>
                 <input type="radio" name="q25" value="D"> D) Constitutional Supremacy
             </div>
             <div class="form-group">
                 <label>26. Democratization refers to:</label>
                 <input type="radio" name="q26" value="A" required> A) The state of being a fully established democracy.<br>
                 <input type="radio" name="q26" value="B"> B) The transition process from non-democratic to democratic rule.<br>
                 <input type="radio" name="q26" value="C"> C) The holding of a single election.<br>
                 <input type="radio" name="q26" value="D"> D) The establishment of authoritarian control.
             </div>
             <div class="form-group">
                 <label>27. Which group acts as a bridge between society and government, aggregating interests and offering policy choices?</label>
                 <input type="radio" name="q27" value="A" required> A) Civil Societies<br>
                 <input type="radio" name="q27" value="B"> B) The Media<br>
                 <input type="radio" name="q27" value="C"> C) Political Parties<br>
                 <input type="radio" name="q27" value="D"> D) The Judiciary
             </div>
             <div class="form-group">
                 <label>28. The media's role in monitoring those in power is often referred to as the:</label>
                 <input type="radio" name="q28" value="A" required> A) Agenda-setting role<br>
                 <input type="radio" name="q28" value="B"> B) Civic forum role<br>
                 <input type="radio" name="q28" value="C"> C) Watchdog role<br>
                 <input type="radio" name="q28" value="D"> D) Information provision role
             </div>
             <div class="form-group">
                 <label>29. Civil society, as defined by Larry Diamond, encompasses:</label>
                 <input type="radio" name="q29" value="A" required> A) All government institutions.<br>
                 <input type="radio" name="q29" value="B"> B) The realm of organized, voluntary social life, distinct from the state.<br>
                 <input type="radio" name="q29" value="C"> C) The military and police forces.<br>
                 <input type="radio" name="q29" value="D"> D) Political parties exclusively.
             </div>
             <div class="form-group">
                 <label>30. Human rights are fundamental entitlements belonging to individuals primarily because they are:</label>
                 <input type="radio" name="q30" value="A" required> A) Citizens of a particular state.<br>
                 <input type="radio" name="q30" value="B"> B) Members of a specific ethnic group.<br>
                 <input type="radio" name="q30" value="C"> C) Granted these rights by a government.<br>
                 <input type="radio" name="q30" value="D"> D) Human beings, based on inherent dignity.
             </div>
             <div class="form-group">
                 <label>31. The principle that human rights apply equally to everyone, everywhere, without distinction, is:</label>
                 <input type="radio" name="q31" value="A" required> A) Inalienability<br>
                 <input type="radio" name="q31" value="B"> B) Indivisibility<br>
                 <input type="radio" name="q31" value="C"> C) Universality<br>
                 <input type="radio" name="q31" value="D"> D) Interdependence
             </div>
             <div class="form-group">
                 <label>32. The principle that human rights cannot be lost or taken away is:</label>
                 <input type="radio" name="q32" value="A" required> A) Universality<br>
                 <input type="radio" name="q32" value="B"> B) Inalienability<br>
                 <input type="radio" name="q32" value="C"> C) Interdependence<br>
                 <input type="radio" name="q32" value="D"> D) Equality
             </div>
             <div class="form-group">
                 <label>33. The idea that all human rights (civil, political, economic, social, cultural) are of equal importance and cannot be prioritized over one another reflects the principle of:</label>
                 <input type="radio" name="q33" value="A" required> A) Universality<br>
                 <input type="radio" name="q33" value="B"> B) Inalienability<br>
                 <input type="radio" name="q33" value="C"> C) Indivisibility<br>
                 <input type="radio" name="q33" value="D"> D) Derogability
             </div>
             <div class="form-group">
                 <label>34. The primary 'duty bearer' responsible for respecting, protecting, and fulfilling human rights is typically considered to be:</label>
                 <input type="radio" name="q34" value="A" required> A) Individuals<br>
                 <input type="radio" name="q34" value="B"> B) Non-governmental organizations<br>
                 <input type="radio" name="q34" value="C"> C) The State<br>
                 <input type="radio" name="q34" value="D"> D) International corporations
             </div>
             <div class="form-group">
                 <label>35. The first generation of human rights primarily includes:</label>
                 <input type="radio" name="q35" value="A" required> A) Economic, social, and cultural rights.<br>
                 <input type="radio" name="q35" value="B"> B) Civil and political rights.<br>
                 <input type="radio" name="q35" value="C"> C) Solidarity and environmental rights.<br>
                 <input type="radio" name="q35" value="D"> D) Group rights only.
             </div>
             <div class="form-group">
                 <label>36. Rights such as the right to education, health, and work fall under which category?</label>
                 <input type="radio" name="q36" value="A" required> A) Civil rights<br>
                 <input type="radio" name="q36" value="B"> B) Political rights<br>
                 <input type="radio" name="q36" value="C"> C) Economic, social, and cultural rights (second generation)<br>
                 <input type="radio" name="q36" value="D"> D) Solidarity rights (third generation)
             </div>
             <div class="form-group">
                 <label>37. Third generation rights, such as the right to peace or a clean environment, are often referred to as:</label>
                 <input type="radio" name="q37" value="A" required> A) Negative rights<br>
                 <input type="radio" name="q37" value="B"> B) Individual rights<br>
                 <input type="radio" name="q37" value="C"> C) Political rights<br>
                 <input type="radio" name="q37" value="D"> D) Solidarity or group rights
             </div>
             <div class="form-group">
                 <label>38. Civil and political rights are often considered 'negative' rights because they primarily require the state to:</label>
                 <input type="radio" name="q38" value="A" required> A) Provide extensive resources and services.<br>
                 <input type="radio" name="q38" value="B"> B) Refrain from interfering with individual freedoms.<br>
                 <input type="radio" name="q38" value="C"> C) Actively restructure society.<br>
                 <input type="radio" name="q38" value="D"> D) Engage in international cooperation.
             </div>
             <div class="form-group">
                 <label>39. The temporary suspension of certain rights during a state of emergency is known as:</label>
                 <input type="radio" name="q39" value="A" required> A) Limitation<br>
                 <input type="radio" name="q39" value="B"> B) Derogation<br>
                 <input type="radio" name="q39" value="C"> C) Violation<br>
                 <input type="radio" name="q39" value="D"> D) Fulfillment
             </div>
             <div class="form-group">
                 <label>40. Justifiable and lawful restrictions on the exercise of rights, often applicable in normal times, are known as:</label>
                 <input type="radio" name="q40" value="A" required> A) Derogations<br>
                 <input type="radio" name="q40" value="B"> B) Violations<br>
                 <input type="radio" name="q40" value="C"> C) Limitations<br>
                 <input type="radio" name="q40" value="D"> D) Abuses
             </div>
             <div class="form-group">
                 <label>41. Which right is generally considered non-derogable under international law (e.g., ICCPR)?</label>
                 <input type="radio" name="q41" value="A" required> A) Freedom of movement<br>
                 <input type="radio" name="q41" value="B"> B) Freedom of assembly<br>
                 <input type="radio" name="q41" value="C"> C) Freedom from torture<br>
                 <input type="radio" name="q41" value="D"> D) Right to property
             </div>
             <div class="form-group">
                 <label>42. According to the FDRE Constitution (Art. 93), which right is non-derogable during a state of emergency?</label>
                 <input type="radio" name="q42" value="A" required> A) Freedom of expression<br>
                 <input type="radio" name="q42" value="B"> B) Right to property<br>
                 <input type="radio" name="q42" value="C"> C) Freedom of religion (Article 18)<br>
                 <input type="radio" name="q42" value="D"> D) Right to vote
             </div>
             <div class="form-group">
                 <label>43. The Universal Declaration of Human Rights (UDHR) is legally:</label>
                 <input type="radio" name="q43" value="A" required> A) A binding treaty on all UN members.<br>
                 <input type="radio" name="q43" value="B"> B) A non-binding declaration, though highly influential.<br>
                 <input type="radio" name="q43" value="C"> C) A regional human rights instrument.<br>
                 <input type="radio" name="q43" value="D"> D) Part of the Ethiopian Constitution.
             </div>
             <div class="form-group">
                 <label>44. The International Bill of Human Rights primarily consists of:</label>
                 <input type="radio" name="q44" value="A" required> A) The UN Charter only.<br>
                 <input type="radio" name="q44" value="B"> B) The UDHR only.<br>
                 <input type="radio" name="q44" value="C"> C) The UDHR, ICCPR, and ICESCR.<br>
                 <input type="radio" name="q44" value="D"> D) Regional human rights charters.
             </div>
             <div class="form-group">
                 <label>45. Ethiopia's commitment to international human rights law is reflected in the FDRE Constitution (Art. 13) which mandates interpretation of constitutional rights in conformity with:</label>
                 <input type="radio" name="q45" value="A" required> A) Traditional Ethiopian laws only.<br>
                 <input type="radio" name="q45" value="B"> B) The UDHR, International Covenants, and other instruments ratified by Ethiopia.<br>
                 <input type="radio" name="q45" value="C"> C) The constitution of the United States.<br>
                 <input type="radio" name="q45" value="D"> D) Resolutions of the African Union only.
             </div>
             <div class="form-group">
                 <label>46. Which body is part of the Ethiopian national human rights system?</label>
                 <input type="radio" name="q46" value="A" required> A) The African Court on Human and Peoples' Rights<br>
                 <input type="radio" name="q46" value="B"> B) The UN Human Rights Council<br>
                 <input type="radio" name="q46" value="C"> C) The Ethiopian Human Rights Commission (EHRC)<br>
                 <input type="radio" name="q46" value="D"> D) The European Court of Human Rights
             </div>
             <div class="form-group">
                 <label>47. The African Charter on Human and Peoples' Rights is a key instrument within the:</label>
                 <input type="radio" name="q47" value="A" required> A) United Nations system<br>
                 <input type="radio" name="q47" value="B"> B) European Union system<br>
                 <input type="radio" name="q47" value="C"> C) Organization of American States system<br>
                 <input type="radio" name="q47" value="D"> D) African Union system
             </div>
             <div class="form-group">
                 <label>48. Robert Dahl's criteria for procedural democracy include:</label>
                 <input type="radio" name="q48" value="A" required> A) State control over all media.<br>
                 <input type="radio" name="q48" value="B"> B) The right of citizens to form independent associations.<br>
                 <input type="radio" name="q48" value="C"> C) A single-party political system.<br>
                 <input type="radio" name="q48" value="D"> D) Restrictions on the right to run for office.
             </div>
             <div class="form-group">
                 <label>49. Lincoln's phrase "government of the people, by the people, for the people" encapsulates aspects of:</label>
                 <input type="radio" name="q49" value="A" required> A) Authoritarian rule<br>
                 <input type="radio" name="q49" value="B"> B) Popular sovereignty and public interest<br>
                 <input type="radio" name="q49" value="C"> C) Elite governance<br>
                 <input type="radio" name="q49" value="D"> D) Direct democracy only
             </div>
             <div class="form-group">
                 <label>50. The transition from the 1987 PDRE Constitution to the 1995 FDRE Constitution marked a fundamental shift towards:</label>
                 <input type="radio" name="q50" value="A" required> A) A unitary state structure.<br>
                 <input type="radio" name="q50" value="B"> B) A federal and parliamentary system with greater emphasis on rights.<br>
                 <input type="radio" name="q50" value="C"> C) Strengthening the single-party state.<br>
                 <input type="radio" name="q50" value="D"> D) Re-establishing an imperial system.
             </div>
            <!-- End of Chapter 5 Questions -->

            <button type="button" onclick="showReview()">Submit</button>
        </form>
        <div id="error-message" class="hidden">
            <p>Something went wrong. Please try again.</p>
        </div>
    </div>

    <div id="review-section" class="hidden">
        <h2>Review Your Answers</h2>
        <div id="review-content"></div>
        <button onclick="editForm()">Edit</button>
        <button onclick="downloadResponse()" id="download-response">Download My Response</button>
        <button onclick="confirmSubmission()">Confirm Submission</button>
    </div>

    <div id="submission-copy" class="hidden">
        <h2>Your Submitted Answers (Chapter 5)</h2> <!-- Updated Title -->
        <div id="submission-content"></div>
        <button onclick="proceedToPassword()">Proceed</button>
    </div>

    <div id="password-section" class="hidden">
        <h1 id="success-message">Your response has been submitted</h1>
        <p>You can view your result (score) by entering the password.</p>
        <input type="password" id="password" placeholder="Enter password">
        <button onclick="checkPassword()">Submit</button>
        <p id="password-error" class="hidden">Incorrect password. Please try again.</p>
    </div>

    <div id="results" class="hidden">
        <h1>Quiz Results - Chapter 5</h1> <!-- Updated Title -->
        <p id="student-info"></p>
        <div id="answers"></div>
        <p id="score"></p>
        <button id="download-pdf" onclick="downloadPDF()">Download Results PDF</button>
    </div>

    <script>
        let quizData = null;
        let formData = null;
        const { jsPDF } = window.jspdf;
        const TOTAL_QUESTIONS = 50; // Total number of questions is 50

        // Valid login credentials
        const validCredentials = [
            { username: 'section19', password: '123' },
            { username: 'section20', password: '123' },
            { username: 'muzemuza', password: 'moh' },
            { username: 'section21', password: '123' }
        ];

        // *** UPDATED: Structure holding question texts and choices (CHAPTER 5 SET) ***
        const allQuestionsData = {
             q1: { text: 'In a political sense, a constitution primarily signifies:', choices: { A: 'The physical health of the head of state.', B: 'The fundamental law and framework of the state.', C: 'The platform of the ruling political party.', D: 'The economic structure of a country.' } },
             q2: { text: 'Constitutionalism implies that:', choices: { A: 'A country possesses a written constitution document.', B: 'Government powers are limited and exercised according to the rule of law.', C: 'The constitution can be easily changed by the ruling party.', D: 'The military is the supreme authority.' } },
             q3: { text: 'Which feature highlights that a constitution provides the foundational principles upon which other laws are built?', choices: { A: 'Permanency', B: 'Generality', C: 'Supremacy', D: 'Codification' } },
             q4: { text: 'The feature of \'supremacy\' means a constitution:', choices: { A: 'Is easily amended.', B: 'Takes precedence over all other laws.', C: 'Applies only to government officials.', D: 'Is primarily composed of traditions.' } },
             q5: { text: 'A constitution that outlines specific processes for its amendment, often requiring more than a simple majority vote, is classified as:', choices: { A: 'Flexible', B: 'Unitary', C: 'Rigid', D: 'Nominal' } },
             q6: { text: 'A constitution whose rules and principles largely correspond with the actual practices of government and citizens is termed:', choices: { A: 'Nominal', B: 'Flexible', C: 'Unwritten', D: 'Effective' } },
             q7: { text: 'A key purpose of a constitution is to serve as a framework for government, meaning it:', choices: { A: 'Details every single law needed.', B: 'Organizes government operations and outlines powers/functions.', C: 'Guarantees economic prosperity.', D: 'Can be ignored by the executive branch.' } },
             q8: { text: 'Constitutionalism ensures government actions are legitimate by checking if they are:', choices: { A: 'Popular with the majority.', B: 'Economically efficient.', C: 'In accordance with pre-determined laws and rules.', D: 'Supported by the military.' } },
             q9: { text: 'Prior to 1931, Ethiopian constitutional tradition relied significantly on documents like:', choices: { A: 'The Universal Declaration of Human Rights.', B: 'The Magna Carta.', C: 'The Kebra Nagast and Fetha Negest.', D: 'The Napoleonic Code.' } },
             q10: { text: 'The Fetha Negest served as a source for which types of law in traditional Ethiopia?', choices: { A: 'Only religious law.', B: 'Only criminal law.', C: 'Constitutional, civil, and criminal law.', D: 'Only international law.' } },
             q11: { text: 'The primary source of legitimacy emphasized in the Kebra Nagast for Ethiopian rulers was:', choices: { A: 'Military conquest.', B: 'Popular election.', C: 'Descent from the Solomonic dynasty.', D: 'Economic control.' } },
             q12: { text: 'A major internal factor leading to the 1931 Constitution was Emperor Haile Selassie\'s desire to:', choices: { A: 'Increase the power of the regional nobility.', B: 'Centralize state power and reduce the influence of traditional nobles.', C: 'Establish a federal system.', D: 'Adopt socialist principles.' } },
             q13: { text: 'The 1955 Revised Constitution was partly influenced by:', choices: { A: 'The Italian occupation\'s success.', B: 'The federation of Ethiopia and Eritrea.', C: 'The decline of the monarchy\'s power.', D: 'A shift to a multi-party system.' } },
             q14: { text: 'A key difference introduced in the 1987 PDRE Constitution compared to imperial ones was:', choices: { A: 'The strengthening of the Emperor\'s divine right.', B: 'The formal separation of state and religion (secularism).', C: 'The establishment of a federal structure.', D: 'The guarantee of multi-party elections.' } },
             q15: { text: 'The 1995 FDRE Constitution allocates approximately how much of its content to rights?', choices: { A: 'One-tenth', B: 'One-half', C: 'One-third', D: 'Three-quarters' } },
             q16: { text: 'A defining feature of the 1995 FDRE Constitution, distinguishing it significantly from previous ones, is:', choices: { A: 'The concentration of all power in the executive.', B: 'The establishment of a federal structure based on nations, nationalities, and peoples.', C: 'The declaration of Ethiopia as a religious state.', D: 'The abolition of all human rights provisions.' } },
             q17: { text: 'The word \'democracy\' originates from Greek words meaning:', choices: { A: 'Rule by the wealthy.', B: 'Rule by the knowledgeable.', C: 'Rule by the people.', D: 'Rule by the priests.' } },
             q18: { text: 'Joseph Schumpeter defined democracy as an "institutional arrangement for arriving at political decisions" through:', choices: { A: 'Consensus among elites.', B: 'A competitive struggle for the people\'s vote.', C: 'Divine appointment.', D: 'Hereditary succession.' } },
             q19: { text: 'Direct democracy involves decision-making by:', choices: { A: 'Elected representatives.', B: 'A single authoritarian leader.', C: 'The entire body of citizens directly.', D: 'An independent judiciary.' } },
             q20: { text: 'Which is a core value of democracy, relating to fairness in distributing benefits/burdens and correcting wrongs?', choices: { A: 'Liberty', B: 'Equality', C: 'Justice', D: 'Sovereignty' } },
             q21: { text: 'Political equality primarily implies:', choices: { A: 'Equal economic outcomes for all.', B: 'Equal political rights, such as the right to vote (one person, one vote).', C: 'Identical political opinions among citizens.', D: 'The absence of political parties.' } },
             q22: { text: 'The principle that ultimate political authority rests with the people is known as:', choices: { A: 'Rule of Law', B: 'Separation of Powers', C: 'Popular Sovereignty', D: 'Constitutional Supremacy' } },
             q23: { text: 'The principle requiring government to act according to clear, objective, publicly disclosed laws, and ensuring equality before the law, is:', choices: { A: 'Secularism', B: 'Rule of Law', C: 'Majority Rule', D: 'Federalism' } },
             q24: { text: 'Secularism in a democratic context primarily means:', choices: { A: 'The government must promote atheism.', B: 'Religion is banned from public life.', C: 'Separation of state institutions and religious institutions/affairs.', D: 'All citizens must belong to the same religion.' } },
             q25: { text: 'The division of governmental power among legislative, executive, and judicial branches is the principle of:', choices: { A: 'Popular Sovereignty', B: 'Federalism', C: 'Separation of Powers', D: 'Constitutional Supremacy' } },
             q26: { text: 'Democratization refers to:', choices: { A: 'The state of being a fully established democracy.', B: 'The transition process from non-democratic to democratic rule.', C: 'The holding of a single election.', D: 'The establishment of authoritarian control.' } },
             q27: { text: 'Which group acts as a bridge between society and government, aggregating interests and offering policy choices?', choices: { A: 'Civil Societies', B: 'The Media', C: 'Political Parties', D: 'The Judiciary' } },
             q28: { text: 'The media\'s role in monitoring those in power is often referred to as the:', choices: { A: 'Agenda-setting role', B: 'Civic forum role', C: 'Watchdog role', D: 'Information provision role' } },
             q29: { text: 'Civil society, as defined by Larry Diamond, encompasses:', choices: { A: 'All government institutions.', B: 'The realm of organized, voluntary social life, distinct from the state.', C: 'The military and police forces.', D: 'Political parties exclusively.' } },
             q30: { text: 'Human rights are fundamental entitlements belonging to individuals primarily because they are:', choices: { A: 'Citizens of a particular state.', B: 'Members of a specific ethnic group.', C: 'Granted these rights by a government.', D: 'Human beings, based on inherent dignity.' } },
             q31: { text: 'The principle that human rights apply equally to everyone, everywhere, without distinction, is:', choices: { A: 'Inalienability', B: 'Indivisibility', C: 'Universality', D: 'Interdependence' } },
             q32: { text: 'The principle that human rights cannot be lost or taken away is:', choices: { A: 'Universality', B: 'Inalienability', C: 'Interdependence', D: 'Equality' } },
             q33: { text: 'The idea that all human rights (civil, political, economic, social, cultural) are of equal importance and cannot be prioritized over one another reflects the principle of:', choices: { A: 'Universality', B: 'Inalienability', C: 'Indivisibility', D: 'Derogability' } },
             q34: { text: 'The primary \'duty bearer\' responsible for respecting, protecting, and fulfilling human rights is typically considered to be:', choices: { A: 'Individuals', B: 'Non-governmental organizations', C: 'The State', D: 'International corporations' } },
             q35: { text: 'The first generation of human rights primarily includes:', choices: { A: 'Economic, social, and cultural rights.', B: 'Civil and political rights.', C: 'Solidarity and environmental rights.', D: 'Group rights only.' } },
             q36: { text: 'Rights such as the right to education, health, and work fall under which category?', choices: { A: 'Civil rights', B: 'Political rights', C: 'Economic, social, and cultural rights (second generation)', D: 'Solidarity rights (third generation)' } },
             q37: { text: 'Third generation rights, such as the right to peace or a clean environment, are often referred to as:', choices: { A: 'Negative rights', B: 'Individual rights', C: 'Political rights', D: 'Solidarity or group rights' } },
             q38: { text: 'Civil and political rights are often considered \'negative\' rights because they primarily require the state to:', choices: { A: 'Provide extensive resources and services.', B: 'Refrain from interfering with individual freedoms.', C: 'Actively restructure society.', D: 'Engage in international cooperation.' } },
             q39: { text: 'The temporary suspension of certain rights during a state of emergency is known as:', choices: { A: 'Limitation', B: 'Derogation', C: 'Violation', D: 'Fulfillment' } },
             q40: { text: 'Justifiable and lawful restrictions on the exercise of rights, often applicable in normal times, are known as:', choices: { A: 'Derogations', B: 'Violations', C: 'Limitations', D: 'Abuses' } },
             q41: { text: 'Which right is generally considered non-derogable under international law (e.g., ICCPR)?', choices: { A: 'Freedom of movement', B: 'Freedom of assembly', C: 'Freedom from torture', D: 'Right to property' } },
             q42: { text: 'According to the FDRE Constitution (Art. 93), which right is non-derogable during a state of emergency?', choices: { A: 'Freedom of expression', B: 'Right to property', C: 'Freedom of religion (Article 18)', D: 'Right to vote' } },
             q43: { text: 'The Universal Declaration of Human Rights (UDHR) is legally:', choices: { A: 'A binding treaty on all UN members.', B: 'A non-binding declaration, though highly influential.', C: 'A regional human rights instrument.', D: 'Part of the Ethiopian Constitution.' } },
             q44: { text: 'The International Bill of Human Rights primarily consists of:', choices: { A: 'The UN Charter only.', B: 'The UDHR only.', C: 'The UDHR, ICCPR, and ICESCR.', D: 'Regional human rights charters.' } },
             q45: { text: 'Ethiopia\'s commitment to international human rights law is reflected in the FDRE Constitution (Art. 13) which mandates interpretation of constitutional rights in conformity with:', choices: { A: 'Traditional Ethiopian laws only.', B: 'The UDHR, International Covenants, and other instruments ratified by Ethiopia.', C: 'The constitution of the United States.', D: 'Resolutions of the African Union only.' } },
             q46: { text: 'Which body is part of the Ethiopian national human rights system?', choices: { A: 'The African Court on Human and Peoples\' Rights', B: 'The UN Human Rights Council', C: 'The Ethiopian Human Rights Commission (EHRC)', D: 'The European Court of Human Rights' } },
             q47: { text: 'The African Charter on Human and Peoples\' Rights is a key instrument within the:', choices: { A: 'United Nations system', B: 'European Union system', C: 'Organization of American States system', D: 'African Union system' } },
             q48: { text: 'Robert Dahl\'s criteria for procedural democracy include:', choices: { A: 'State control over all media.', B: 'The right of citizens to form independent associations.', C: 'A single-party political system.', D: 'Restrictions on the right to run for office.' } },
             q49: { text: 'Lincoln\'s phrase "government of the people, by the people, for the people" encapsulates aspects of:', choices: { A: 'Authoritarian rule', B: 'Popular sovereignty and public interest', C: 'Elite governance', D: 'Direct democracy only' } },
             q50: { text: 'The transition from the 1987 PDRE Constitution to the 1995 FDRE Constitution marked a fundamental shift towards:', choices: { A: 'A unitary state structure.', B: 'A federal and parliamentary system with greater emphasis on rights.', C: 'Strengthening the single-party state.', D: 'Re-establishing an imperial system.' } }
        };


        // *** UPDATED: Correct answers mapped to letters (CHAPTER 5 SET) ***
        const correctAnswersMap = {
            q1: 'B', q2: 'B', q3: 'B', q4: 'B', q5: 'C',
            q6: 'D', q7: 'B', q8: 'C', q9: 'C', q10: 'C',
            q11: 'C', q12: 'B', q13: 'B', q14: 'B', q15: 'C',
            q16: 'B', q17: 'C', q18: 'B', q19: 'C', q20: 'C',
            q21: 'B', q22: 'C', q23: 'B', q24: 'C', q25: 'C',
            q26: 'B', q27: 'C', q28: 'C', q29: 'B', q30: 'D',
            q31: 'C', q32: 'B', q33: 'C', q34: 'C', q35: 'B',
            q36: 'C', q37: 'D', q38: 'B', q39: 'B', q40: 'C',
            q41: 'C', q42: 'C', q43: 'B', q44: 'C', q45: 'B',
            q46: 'C', q47: 'D', q48: 'B', q49: 'B', q50: 'B'
        };


        // --- Functions ---

        function checkLogin() {
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('login-password').value.trim();
            const errorMessage = document.getElementById('login-error');
            const loginSection = document.getElementById('login-section');
            const quizForm = document.getElementById('quiz-form');

            const isValid = validCredentials.some(cred =>
                cred.username === username && cred.password === password
            );

            if (isValid) {
                errorMessage.classList.add('hidden');
                loginSection.classList.add('hidden');
                quizForm.classList.remove('hidden');
            } else {
                errorMessage.classList.remove('hidden');
            }
        }

        function showReview() {
            const form = document.getElementById('mcie-quiz');
            formData = new FormData(form);
            const data = Object.fromEntries(formData);

             // Check if all questions are answered (Loops up to TOTAL_QUESTIONS = 50)
             let allAnswered = true;
             for (let i = 1; i <= TOTAL_QUESTIONS; i++) {
                 if (!data[`q${i}`]) {
                     allAnswered = false;
                     break;
                 }
             }

             if (!data.name || !data.id_number || !data.section || !data.email || !data.phone || !allAnswered) {
                 alert('Please fill in all personal information and answer all questions before submitting.');
                 return;
             }

            quizData = {
                name: data.name,
                id_number: data.id_number,
                section: data.section,
                email: data.email,
                phone: data.phone,
                answers: {},
                questions: allQuestionsData
            };

            let reviewHTML = `
                <p><strong>Name:</strong> ${data.name}</p>
                <p><strong>ID Number:</strong> ${data.id_number}</p>
                <p><strong>Section:</strong> ${data.section}</p>
                <p><strong>Email:</strong> ${data.email}</p>
                <p><strong>Phone Number:</strong> ${data.phone}</p>
                <hr>
                <h3>Your Answers:</h3>
            `;

            // Loop up to TOTAL_QUESTIONS = 50
            for (let i = 1; i <= TOTAL_QUESTIONS; i++) {
                const qKey = `q${i}`;
                const userAnswer = data[qKey];
                quizData.answers[qKey] = userAnswer;
                const questionInfo = allQuestionsData[qKey];
                const answerText = questionInfo.choices[userAnswer] || 'Not Answered';
                reviewHTML += `<p><strong>Question ${i}:</strong> ${questionInfo.text}<br>Your answer: ${userAnswer}) ${answerText}</p>`;
            }

            const reviewContent = document.getElementById('review-content');
            reviewContent.innerHTML = reviewHTML;
            document.getElementById('quiz-form').classList.add('hidden');
            document.getElementById('review-section').classList.remove('hidden');
        }

        function editForm() {
            document.getElementById('review-section').classList.add('hidden');
            document.getElementById('quiz-form').classList.remove('hidden');
        }

        function downloadResponse() {
            if (!quizData) return;
            const doc = new jsPDF();
            let y = 10;
            const pageHeight = doc.internal.pageSize.height;
            const pageWidth = doc.internal.pageSize.width;
            const margin = 10;
            const effectiveWidth = pageWidth - margin * 2;

            doc.setFontSize(16);
            doc.text('MCIE Quiz Response - Chapter 5', pageWidth / 2, y, { align: 'center' }); // Updated Title
            y += 10;

            doc.setFontSize(12);
            doc.text(`Name: ${quizData.name}`, margin, y); y += 7;
            doc.text(`ID: ${quizData.id_number}`, margin, y); y += 7;
            doc.text(`Section: ${quizData.section}`, margin, y); y += 7;
            doc.text(`Email: ${quizData.email}`, margin, y); y += 7;
            doc.text(`Phone: ${quizData.phone}`, margin, y); y += 10;

             // Loop up to TOTAL_QUESTIONS = 50
            for (let i = 1; i <= TOTAL_QUESTIONS; i++) {
                 const qKey = `q${i}`;
                 const question = quizData.questions[qKey];
                 const userAnswer = quizData.answers[qKey];
                 const answerText = question.choices[userAnswer] || 'Not Answered';
                 const questionText = question.text;

                 const questionLines = doc.splitTextToSize(`Question ${i}: ${questionText}`, effectiveWidth);
                 const answerLines = doc.splitTextToSize(`Your answer: ${userAnswer}) ${answerText}`, effectiveWidth);
                 const spaceNeeded = (questionLines.length * 5) + 2 + (answerLines.length * 5) + 5;

                 if (y + spaceNeeded > pageHeight - margin) {
                    doc.addPage();
                    y = margin;
                 }
                doc.setFont('helvetica', 'bold');
                doc.text(questionLines, margin, y);
                y += (questionLines.length * 5) + 2;
                doc.setFont('helvetica', 'normal');
                if (y > pageHeight - margin) { doc.addPage(); y = margin; }
                doc.text(answerLines, margin, y);
                y += (answerLines.length * 5) + 5;
            }
            doc.save(`quiz_response_${quizData.id_number}_ch5.pdf`); // Updated filename
        }

        async function confirmSubmission() {
            // *** This function SUBMITS TO YOUR BACKEND (/submit-quiz) ***
            if (confirm('Are you sure you want to submit your answers?')) {
                if (!quizData || !formData) {
                     console.error("Quiz data or form data is missing.");
                     alert("Error: Cannot submit. Please try filling the form again.");
                     editForm();
                     return;
                }
                const data = Object.fromEntries(formData);
                let score = 0;
                // Loop up to TOTAL_QUESTIONS = 50
                for (let i = 1; i <= TOTAL_QUESTIONS; i++) {
                    const qKey = `q${i}`;
                    if (data[qKey] === correctAnswersMap[qKey]) {
                        score++;
                    }
                }
                quizData.score = score;

                // Prepare data for YOUR backend (/submit-quiz)
                const submissionData = {
                    name: data.name,
                    id_number: data.id_number,
                    section: data.section,
                    email: data.email,
                    phone: data.phone,
                    score: score,
                    totalQuestions: TOTAL_QUESTIONS // Sends 50
                    // quizChapter: 'Chapter 5' // Optional: Add if backend uses it
                };

                try {
                    // *** FETCH URL points to YOUR server's backend endpoint ***
                    const response = await fetch('/submit-quiz', { // <--- Corrected URL
                        method: 'POST',
                        body: JSON.stringify(submissionData),
                        headers: {
                            'Accept': 'application/json',
                            'Content-Type': 'application/json'
                        }
                    });

                    if (response.ok) {
                        const result = await response.json();
                        console.log("Backend submission successful:", result);

                        const submissionContent = document.getElementById('submission-content');
                         let submissionHTML = `
                            <p><strong>Name:</strong> ${quizData.name}</p>
                            <p><strong>ID Number:</strong> ${quizData.id_number}</p>
                            <p><strong>Section:</strong> ${quizData.section}</p>
                            <p><strong>Email:</strong> ${quizData.email}</p>
                            <p><strong>Phone Number:</strong> ${quizData.phone}</p>
                            <hr>
                            <h3>Submitted Answers (Chapter 5):</h3>
                        `;
                         // Loop up to TOTAL_QUESTIONS = 50
                         for (let i = 1; i <= TOTAL_QUESTIONS; i++) {
                             const qKey = `q${i}`;
                             const questionInfo = quizData.questions[qKey];
                             const userAnswer = quizData.answers[qKey];
                             const answerText = questionInfo.choices[userAnswer] || 'Not Answered';
                             submissionHTML += `<p><strong>Question ${i}:</strong> ${questionInfo.text}<br>Your answer: ${userAnswer}) ${answerText}</p>`;
                         }
                        submissionContent.innerHTML = submissionHTML;

                        document.getElementById('review-section').classList.add('hidden');
                        document.getElementById('submission-copy').classList.remove('hidden');

                    } else {
                        // Handle ERROR response from your backend
                        let errorMsg = `Submission failed with status: ${response.status}`;
                        try {
                            const errorData = await response.json();
                            errorMsg = errorData.error || errorMsg;
                        } catch(e) { /* Ignore if response isn't JSON */ }
                        console.error('Backend submission error:', errorMsg);
                        document.getElementById('error-message').innerHTML = `<p>Submission failed: ${errorMsg}. Please check server logs and try again.</p>`;
                        document.getElementById('error-message').classList.remove('hidden');
                        document.getElementById('review-section').classList.add('hidden');
                    }
                } catch (error) {
                    // Handle NETWORK errors
                    console.error('Network/Fetch error:', error);
                    document.getElementById('error-message').innerHTML = `<p>An network error occurred during submission. Is the server running? Please check your connection and try again.</p>`;
                    document.getElementById('error-message').classList.remove('hidden');
                    document.getElementById('review-section').classList.add('hidden');
                }
            }
        }


        function proceedToPassword() {
            document.getElementById('submission-copy').classList.add('hidden');
            document.getElementById('password-section').classList.remove('hidden');
        }

        function checkPassword() {
            const passwordInput = document.getElementById('password').value;
            const correctPassword = 'password';
            const errorMessage = document.getElementById('password-error');
            const passwordSection = document.getElementById('password-section');
            const results = document.getElementById('results');

            if (passwordInput === correctPassword) {
                errorMessage.classList.add('hidden');
                passwordSection.classList.add('hidden');
                results.classList.remove('hidden');
                displayResults();
            } else {
                errorMessage.classList.remove('hidden');
            }
        }

        function displayResults() {
            if (!quizData) {
                document.getElementById('results').innerHTML = '<p>Error: No quiz data found. Please complete the quiz first.</p>';
                return;
            }

             const displayCorrectAnswers = {};
              // Loop up to TOTAL_QUESTIONS = 50
             for(let i = 1; i <= TOTAL_QUESTIONS; i++) {
                 const qKey = `q${i}`;
                 const correctLetter = correctAnswersMap[qKey];
                 const correctText = allQuestionsData[qKey].choices[correctLetter];
                 displayCorrectAnswers[qKey] = `${correctLetter}) ${correctText}`;
             }

            document.getElementById('student-info').innerHTML = `<strong>Name:</strong> ${quizData.name}<br><strong>ID:</strong> ${quizData.id_number}<br><strong>Section:</strong> ${quizData.section}<br><strong>Email:</strong> ${quizData.email}<br><strong>Phone:</strong> ${quizData.phone}`;

            const answersDiv = document.getElementById('answers');
            let answersHTML = '<h3>Detailed Results (Chapter 5):</h3>'; // Updated heading

             // Loop up to TOTAL_QUESTIONS = 50
            for (let i = 1; i <= TOTAL_QUESTIONS; i++) {
                 const qKey = `q${i}`;
                 const question = quizData.questions[qKey];
                 const userAnswer = quizData.answers[qKey];
                 const userAnswerText = question.choices[userAnswer] || 'Not Answered';
                 const isCorrect = userAnswer === correctAnswersMap[qKey];

                 answersHTML += `
                    <div class="question-result">
                        <p><strong>Question ${i}:</strong> ${question.text}</p>
                        <div class="choices" style="font-size:0.9em; margin-left: 15px;">
                            <p>A) ${question.choices.A}</p>
                            <p>B) ${question.choices.B}</p>
                            <p>C) ${question.choices.C}</p>
                            <p>D) ${question.choices.D}</p>
                        </div>
                        <p>Your answer: ${userAnswer}) ${userAnswerText} ${isCorrect ? '<span style="color:green; font-weight:bold;">(Correct)</span>' : '<span style="color:red; font-weight:bold;">(Incorrect)</span>'}</p>
                        ${!isCorrect ? `<p style="color:blue;">Correct answer: ${displayCorrectAnswers[qKey]}</p>` : ''}
                    </div>
                `;
            }
            answersDiv.innerHTML = answersHTML;

            document.getElementById('score').textContent = `Final Score: ${quizData.score} / ${TOTAL_QUESTIONS}`;
        }

        function downloadPDF() {
            if (!quizData) return;
            const doc = new jsPDF();
            let y = 10;
            const pageHeight = doc.internal.pageSize.height;
            const pageWidth = doc.internal.pageSize.width;
            const margin = 10;
            const effectiveWidth = pageWidth - margin * 2;

             const displayCorrectAnswers = {};
              // Loop up to TOTAL_QUESTIONS = 50
             for(let i = 1; i <= TOTAL_QUESTIONS; i++) {
                 const qKey = `q${i}`;
                 const correctLetter = correctAnswersMap[qKey];
                 const correctText = allQuestionsData[qKey].choices[correctLetter];
                 displayCorrectAnswers[qKey] = `${correctLetter}) ${correctText}`;
             }

            doc.setFontSize(16);
            doc.text('MCIE Quiz Results - Chapter 5', pageWidth / 2, y, { align: 'center' }); // Updated Title
            y += 10;

            doc.setFontSize(12);
            doc.text(`Name: ${quizData.name}`, margin, y); y += 7;
            doc.text(`ID: ${quizData.id_number}`, margin, y); y += 7;
            doc.text(`Section: ${quizData.section}`, margin, y); y += 7;
            doc.text(`Email: ${quizData.email}`, margin, y); y += 7;
            doc.text(`Phone: ${quizData.phone}`, margin, y); y += 10;

            doc.setFont('helvetica', 'bold');
            doc.text(`Final Score: ${quizData.score} / ${TOTAL_QUESTIONS}`, pageWidth / 2, y, { align: 'center' });
            y += 10;
            doc.setFont('helvetica', 'normal');

             // Loop up to TOTAL_QUESTIONS = 50
            for (let i = 1; i <= TOTAL_QUESTIONS; i++) {
                 const qKey = `q${i}`;
                 const question = quizData.questions[qKey];
                 const userAnswer = quizData.answers[qKey];
                 const userAnswerText = question.choices[userAnswer] || 'Not Answered';
                 const isCorrect = userAnswer === correctAnswersMap[qKey];
                 const questionText = question.text;
                 const correctAnswerFull = displayCorrectAnswers[qKey];

                 const qLines = doc.splitTextToSize(`Question ${i}: ${questionText}`, effectiveWidth);
                 const choicesLines = 4 * 5;
                 const yourAnsLines = doc.splitTextToSize(`Your answer: ${userAnswer}) ${userAnswerText} ${isCorrect ? '(Correct)' : '(Incorrect)'}`, effectiveWidth);
                 const correctAnsLines = isCorrect ? 0 : doc.splitTextToSize(`Correct answer: ${correctAnswerFull}`, effectiveWidth).length * 5;
                 const spaceNeeded = (qLines.length * 5) + 2 + choicesLines + 7 + (yourAnsLines.length * 5) + 7 + correctAnsLines + 5;

                 if (y + spaceNeeded > pageHeight - margin) {
                    doc.addPage();
                    y = margin;
                }
                doc.setFont('helvetica', 'bold');
                doc.text(qLines, margin, y);
                y += (qLines.length * 5) + 2;
                doc.setFont('helvetica', 'normal');
                if (y > pageHeight - margin * 3) { doc.addPage(); y = margin; }
                doc.setFontSize(10);
                doc.text(`  A) ${question.choices.A}`, margin + 5, y); y += 5;
                doc.text(`  B) ${question.choices.B}`, margin + 5, y); y += 5;
                doc.text(`  C) ${question.choices.C}`, margin + 5, y); y += 5;
                doc.text(`  D) ${question.choices.D}`, margin + 5, y); y += 7;
                doc.setFontSize(12);
                if (y > pageHeight - margin * 2) { doc.addPage(); y = margin; }
                doc.text(`Your answer: ${userAnswer}) ${userAnswerText} ${isCorrect ? '(Correct)' : '(Incorrect)'}`, margin, y); y += 7;
                if (!isCorrect) {
                    doc.setTextColor(0, 0, 255);
                    doc.text(`Correct answer: ${correctAnswerFull}`, margin, y); y += 7;
                    doc.setTextColor(0, 0, 0);
                }
                y += 5;
            }

            if (y > pageHeight - margin) { doc.addPage(); y = margin; }
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(14);
            doc.text(`Final Score: ${quizData.score} / ${TOTAL_QUESTIONS}`, pageWidth / 2, y, { align: 'center' });

            doc.save(`quiz_results_${quizData.id_number}_ch5.pdf`); // Updated filename
        }

    </script>
</body>
</html>